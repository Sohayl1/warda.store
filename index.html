<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>

    <meta property="og:site_name" content="Rose Garden">
    <meta property="og:title" content="Rose Garden | باقات ورد فاخرة وتوصيل سريع في جدة">
    <meta property="og:description" content="اكتشف أجمل باقات الورد الطبيعي والهدايا المميزة. خدمة صمم باقتك بنفسك، وتوصيل فوري خلال ساعتين.">
    <meta property="og:image" content="https://i.postimg.cc/fRhb2V5f/file.jpg">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rosegarden-flax.vercel.app/">
    <meta itemprop="name" content="Rose Garden | متجر ورود">
    <meta itemprop="description" content="أفضل متجر لبيع الورود وتصميم الباقات في جدة.">
    <meta itemprop="image" content="https://i.postimg.cc/fRhb2V5f/file.jpg">

    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Marhey:wght@400;500&display=swap" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rose Garden | متجر ورود</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@400;500;600;700&family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>

        /* تنسيق أزرار التحكم بالكمية في السلة */
        .qty-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 8px;
            background: #f9f9f9;
            padding: 4px 8px;
            border-radius: 20px;
            width: fit-content;
        }

        .qty-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 1px solid #e75480; /* نفس لون الـ accent-pink */
            background: white;
            color: #e75480;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.2s ease;
            padding: 0;
        }

            .qty-btn:hover {
                background: #e75480;
                color: white;
            }

            .qty-btn:active {
                transform: scale(0.9);
            }

        .qty-text {
            font-weight: bold;
            font-size: 0.95rem;
            color: var(--text-main);
            min-width: 20px;
            text-align: center;
        }

        /* تنسيق قائمة نتائج البحث */
        .search-results-dropdown {
            position: absolute;
            top: 100%; /* تظهر أسفل الحقل مباشرة */
            left: 0;
            width: 100%;
            background: white;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            z-index: 2000;
            max-height: 300px;
            overflow-y: auto;
            display: none; /* مخفية افتراضياً */
            border: 1px solid #eee;
            border-top: none;
        }

        /* العنصر الواحد داخل القائمة */
        .search-result-item {
            display: flex;
            align-items: center;
            padding: 10px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #f9f9f9;
        }

            .search-result-item:hover {
                background-color: #fff0f3; /* لون وردي فاتح عند التمرير */
            }

            .search-result-item img {
                width: 40px;
                height: 40px;
                border-radius: 8px;
                object-fit: cover;
                margin-left: 10px; /* مسافة بين الصورة والنص */
            }

            .search-result-item .info {
                flex: 1;
            }

            .search-result-item h4 {
                font-size: 0.9rem;
                margin: 0;
                color: var(--text-main);
            }

            .search-result-item span {
                font-size: 0.8rem;
                color: var(--accent-pink);
                font-weight: bold;
            }

        /* تنسيق عداد السلة في الموبايل */
        .mobile-badge {
            position: absolute;
            top: 2px; /* مسافة من أعلى الأيقونة */
            background-color: #ff4757; /* لون أحمر */
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex; /* عشان الكلام ييجي في النص */
            align-items: center;
            justify-content: center;
            border: 2px solid white; /* إطار أبيض يفصله عن الأيقونة */
            z-index: 10;
            /* تحريكه قليلاً لليسار عشان ييجي فوق طرف السلة */
            left: 50%;
            margin-left: 5px;
        }

        /* تنسيق أيقونة العملة */
        .currency-icon {
            width: 20px; /* عرض اللوجو */
            height: 20px; /* ارتفاع اللوجو */
            object-fit: contain;
            vertical-align: middle; /* محاذاة في وسط السطر مع الرقم */
            margin-right: 4px; /* مسافة صغيرة بين الرقم واللوجو */
            display: inline-block;
            transform: translateY(-2px); /* ضبط دقيق للمحاذاة */
        }

        /* تكبير اللوجو قليلاً في صفحة المنتج وسلة الشراء */
        .price-box .currency-icon,
        .total .currency-icon,
        .total-price .currency-icon {
            width: 24px;
            height: 24px;
        }

        /* تنسيق لوجو الهيرو الجديد */
        .hero-logo {
            width: 160px; /* حجم اللوجو */
            height: 160px;
            object-fit: cover;
            border-radius: 50%; /* لجعله دائري */
            border: 5px solid rgba(255, 255, 255, 0.4); /* إطار أبيض نصف شفاف */
            box-shadow: 0 10px 30px rgba(231, 84, 128, 0.4); /* ظل وردي ناعم */
            margin-top: 25px;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
        }

            /* تأثير عند مرور الماوس على اللوجو */
            .hero-logo:hover {
                transform: scale(1.1) rotate(5deg);
                border-color: #fff;
                box-shadow: 0 15px 40px rgba(231, 84, 128, 0.6);
            }

        /* تعديل للموبايل ليكون الحجم مناسب */
        @media (max-width: 768px) {
            .hero-logo {
                width: 130px;
                height: 130px;
            }
        }

        /* تنسيق زر اللوكيشن في الفوتر */
        .btn-location {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background-color: rgba(255, 255, 255, 0.1); /* خلفية شفافة */
            color: white !important;
            padding: 8px 20px;
            border-radius: 25px; /* حواف دائرية */
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.2); /* حدود خفيفة */
            transition: all 0.3s ease;
            width: fit-content;
            margin-top: 5px;
        }

            /* تأثير عند المرور بالماوس */
            .btn-location:hover {
                background-color: var(--accent-pink); /* يتحول للون الوردي */
                border-color: var(--accent-pink);
                transform: translateY(-3px); /* يرتفع قليلاً */
                box-shadow: 0 4px 15px rgba(231, 84, 128, 0.4);
            }

        /* تحسين للموبايل */
        @media (max-width: 768px) {
            .btn-location {
                width: 100%; /* الزر يأخذ العرض كامل في الموبايل */
                padding: 10px;
            }
        }
        /* تنسيق زر الواتساب */
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            left: 30px; /* التغيير هنا: أصبح في اليسار */
            width: 60px;
            height: 60px;
            background-color: #25d366;
            color: white;
            border-radius: 50%;
            text-align: center;
            font-size: 35px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            transition: all 0.3s ease;
            animation: ws-pulse 2s infinite;
        }

            .whatsapp-float:hover {
                background-color: #128c7e;
                transform: scale(1.1);
                color: white;
            }

        /* حركة النبض */
        @keyframes ws-pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7);
            }

            70% {
                box-shadow: 0 0 0 15px rgba(37, 211, 102, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0);
            }
        }

        /* تعديل للموبايل */
        @media (max-width: 768px) {
            .whatsapp-float {
                bottom: 90px; /* مرفوع فوق الشريط السفلي */
                left: 20px; /* مسافة من اليسار للموبايل */
                width: 50px;
                height: 50px;
                font-size: 28px;
            }
        }

        /* ==================== إصلاح الدارك مود (مودال + ناف بار) ==================== */

        /* 1. إصلاح الشريط السفلي للموبايل (Mobile Nav) */
        body.dark-mode .mobile-bottom-nav {
            background: rgba(15, 23, 42, 0.95) !important; /* كحلي غامق شفاف */
            border-top: 1px solid #334155 !important;
        }

        body.dark-mode .nav-item {
            color: #cbd5e1 !important; /* لون نص رمادي فاتح */
        }

            body.dark-mode .nav-item.active {
                background: rgba(231, 84, 128, 0.2) !important; /* خلفية أيقونة نشطة */
                color: var(--accent-pink) !important;
            }

        /* 2. إصلاح المودال العام (General Modals) */
        body.dark-mode .modal-content {
            background: #1e293b !important; /* لون الكارت الغامق */
            color: #fff !important;
            border: 1px solid #334155 !important;
        }

        body.dark-mode .modal-header {
            background: #1e293b !important;
            border-bottom: 1px solid #334155 !important;
        }

        body.dark-mode .close-btn {
            background: #334155 !important;
            color: #fff !important;
        }

        /* 3. إصلاح مودال صانع الباقات (Bouquet Builder) */
        /* نغير خلفية كل الصناديق الداخلية للأبيض */
        body.dark-mode .sticky-preview-container,
        body.dark-mode .flowers-scroll-container,
        body.dark-mode .style-scroll-container .horizontal-scroll-list, /* خلفية شريط التصميم */
        body.dark-mode .message-container,
        body.dark-mode .bouquet-summary {
            background: #0f172a !important; /* درجة أغمق من المودال للتباين */
            border: 1px solid #334155 !important;
            color: #fff !important;
        }

        /* إصلاح كروت الورد داخل المصمم */
        body.dark-mode .flower-item {
            background: #1e293b !important;
            border-color: #334155 !important;
            color: #fff !important;
        }

            body.dark-mode .flower-item h5,
            body.dark-mode .flower-item div {
                color: #e2e8f0 !important;
            }

        /* إصلاح النصوص والعناوين داخل المودال */
        body.dark-mode .modal h2,
        body.dark-mode .modal h4,
        body.dark-mode .total-price {
            color: #fff !important;
        }

        /* 4. إصلاح حقول الإدخال (Inputs) في الدارك مود */
        body.dark-mode input,
        body.dark-mode textarea,
        body.dark-mode select {
            background: #0f172a !important;
            border: 1px solid #334155 !important;
            color: #fff !important;
        }

            body.dark-mode input::placeholder,
            body.dark-mode textarea::placeholder {
                color: #94a3b8 !important;
            }

        /* 5. إصلاح زرار الحذف (Reset) */
        body.dark-mode .btn-reset {
            color: #ff6b6b !important;
            border-color: #ff6b6b !important;
        }

            body.dark-mode .btn-reset:hover {
                background: rgba(255, 107, 107, 0.1) !important;
            }
        /* ==================== إصلاح خلفية الدارك مود ==================== */
        body.dark-mode .bloom-background {
            /* تغيير لون الطبقة الخلفية للكحلي الغامق */
            background-color: #0f172a !important;
        }

        /* تحسين مظهر الكرات المضيئة (Blobs) في الدارك مود لتكون أهدأ */
        body.dark-mode .blob {
            opacity: 0.25 !important; /* تقليل الشفافية لكي لا تكون ساطعة جداً */
            filter: blur(90px);
        }

        /* تعديل ألوان الكرات نفسها في الدارك مود لتعطي توهج ليلي */
        body.dark-mode .blob-1 {
            background: radial-gradient(circle, #4f46e5 0%, rgba(79, 70, 229, 0) 70%);
        }

        body.dark-mode .blob-2 {
            background: radial-gradient(circle, #9333ea 0%, rgba(147, 51, 234, 0) 70%);
        }

        body.dark-mode .blob-3 {
            background: radial-gradient(circle, #db2777 0%, rgba(219, 39, 119, 0) 70%);
        }

        /* ==================== إزالة الهايلايت الأزرق المزعج ==================== */

        /* 1. إزالة الوميض الأزرق عند اللمس في الموبايل */
        * {
            -webkit-tap-highlight-color: transparent !important;
        }

        /* 2. إزالة البرواز الأزرق عند الضغط (Focus) للأزرار والروابط */
        button:focus, a:focus, input:focus, textarea:focus, select:focus, div:focus {
            outline: none !important;
            box-shadow: none !important; /* تنبيه: ده بيلغي أي ظل، لو عامل ظل مخصص للزرار ممكن تحتاج تشيل السطر ده */
        }

        /* استثناء للأزرار اللي ليها تصميم خاص (عشان نحافظ على شكلها الحلو) */
        .btn-legendary:focus, .btn-buy-large:focus, .btn-quick-add:focus {
            box-shadow: 0 10px 25px rgba(221, 36, 118, 0.5) !important; /* نرجع الظل الأصلي بتاعها */
        }


        /* حاوية الأزرار (عشان ييجوا جنب بعض) */
        .buttons-wrapper {
            display: flex;
            gap: 10px; /* مسافة بين زر الشراء والقلب */
            align-items: center;
        }

            .buttons-wrapper .btn-quick-add,
            .buttons-wrapper .btn-buy-large {
                flex: 1; /* زر الشراء ياخد باقي المساحة */
            }

        /* ==================== صفحة المنتج الكاملة (Full Page View) ==================== */
        #fullProductPage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fffbfd; /* نفس لون الخلفية */
            z-index: 2000; /* فوق كل شيء */
            overflow-y: auto; /* يسمح بالسكرول */
            display: none; /* مخفي افتراضياً */
            padding-bottom: 50px;
            animation: fadeInPage 0.4s ease;
        }

        @keyframes fadeInPage {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .product-page-header {
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            position: sticky;
            top: 0;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .back-btn {
            font-size: 1.2rem;
            color: var(--text-main);
            cursor: pointer;
            background: none;
            border: none;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: bold;
        }

        /* ==================== خلفية Bloom & Blur الخرافية ==================== */

        /* 1. الحاوية الخلفية الثابتة */
        .bloom-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* خلف كل شيء */
            background-color: #fffbfd; /* لون أساسي فاتح جداً */
            overflow: hidden;
        }

        /* 2. الكرات المشعة (The Blobs) */
        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px); /* هذا هو سر التوهج والضبابية القوية */
            opacity: 0.6; /* شفافية لعدم إزعاج العين */
            animation: floatBlob 10s infinite alternate ease-in-out;
        }

        /* تخصيص الكرة الأولى (وردي غامق - أعلى اليسار) */
        .blob-1 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, #ffc3d9 0%, rgba(255,195,217,0) 70%);
            top: -100px;
            left: -100px;
            animation-duration: 25s;
        }

        /* تخصيص الكرة الثانية (بنفسجي فاتح - وسط اليمين) */
        .blob-2 {
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, #e0c3ff 0%, rgba(224,195,255,0) 70%);
            top: 40%;
            right: -50px;
            animation-duration: 30s;
            animation-delay: -5s;
        }

        /* تخصيص الكرة الثالثة (ذهبي خافت - أسفل اليسار) */
        .blob-3 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, #ffeec3 0%, rgba(255,238,195,0) 70%);
            bottom: -150px;
            left: 20%;
            animation-duration: 20s;
            animation-delay: -10s;
        }

        /* 3. حركة انسيابية للكرات */
        @keyframes floatBlob {
            0% {
                transform: translate(0, 0) scale(1);
            }

            100% {
                transform: translate(50px, 50px) scale(1.1);
            }
        }

        /* ==================== تحديث البطاقات لتكون زجاجية (Glassmorphism) ==================== */
        /* هذا سيجعل الخلفية تظهر من خلال البطاقات بشكل جميل */

        .product-card, .cat-card, .navbar, .features-wrapper, .bouquet-summary, .cart-sidebar {
            background: rgba(255, 255, 255, 0.85) !important; /* خلفية بيضاء نصف شفافة */
            backdrop-filter: blur(10px) !important; /* تأثير الزجاج المصنفر */
            border: 1px solid rgba(255, 255, 255, 0.5) !important; /* حدود بيضاء خفيفة */
        }

        /* تعديل بسيط للـ Body لإلغاء الخلفية القديمة */
        body {
            background: transparent !important; /* لأننا وضعنا ديف للخلفية */
            background-image: none !important;
        }

        /* ==================== سكرول بار وردي أنيق (Pinky Scroll) ==================== */

        /* 1. تحديد عرض وارتفاع السكرول */
        ::-webkit-scrollbar {
            width: 6px; /* عرض رفيع مناسب للموبايل */
            height: 6px; /* ارتفاع للسكرول الأفقي (زي شريط الورد) */
        }

        /* 2. خلفية السكرول (المسار) - لون فاتح جداً */
        ::-webkit-scrollbar-track {
            background: #fff0f5; /* وردي باهت جداً (LavenderBlush) */
            border-radius: 10px;
        }

        /* 3. مقبض السكرول (الجزء المتحرك) - الوردي الأساسي */
        ::-webkit-scrollbar-thumb {
            background-color: #e75480; /* نفس لون الـ accent-pink بتاعك */
            border-radius: 10px; /* حواف دائرية كاملة */
            border: 1px solid #fff0f5; /* مسافة صغيرة حوله ليعطي شكلاً أنعم */
        }

            /* 4. تأثير عند الضغط أو الوقوف عليه */
            ::-webkit-scrollbar-thumb:hover {
                background-color: #d81b60; /* لون أغمق قليلاً عند التفاعل */
            }

        /* 5. دعم متصفح فايرفوكس (Firefox) */
        * {
            scrollbar-width: thin; /* رفيع */
            scrollbar-color: #e75480 #fff0f5; /* (لون المقبض) (لون الخلفية) */
        }

        /* تنسيق صندوق اختيار التصميم (الجديد) */
        .style-scroll-container {
            background: #fff;
            margin: 10px 15px 0 15px; /* مسافات مظبوطة */
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            position: relative;
            z-index: 45; /* أقل من الصورة وأعلى من الورد */
        }

            .style-scroll-container h4 {
                margin: 0 0 10px 0;
                font-size: 0.9rem;
                color: var(--accent-pink); /* لون مميز للعنوان */
            }

        /* تنسيق كارت التصميم */
        .design-item {
            flex: 0 0 auto;
            width: 70px; /* أصغر قليلاً من كارت الورد */
            height: 70px;
            border-radius: 50%; /* شكل دائري */
            border: 2px solid #eee;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
        }

            .design-item img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

            /* حالة التصميم النشط (Selected) */
            .design-item.active {
                border-color: var(--accent-pink);
                transform: scale(1.1);
                box-shadow: 0 4px 10px rgba(231, 84, 128, 0.4);
            }

                /* إضافة علامة صح صغيرة على التصميم المختار */
                .design-item.active::after {
                    content: '\f00c'; /* أيقونة صح FontAwesome */
                    font-family: 'Font Awesome 6 Free';
                    font-weight: 900;
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(231, 84, 128, 0.5);
                    color: white;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.2rem;
                }

        /* ==================== الزر الأسطوري (Legendary Button) ==================== */
        .btn-legendary {
            /* --- الألوان الأسطورية --- */
            /* تدرج لوني غني يجمع بين الذهبي، البرتقالي، ولمسة من الوردي الغامق */
            background: linear-gradient(45deg, #FF512F 0%, #DD2476 25%, #F09819 51%, #FF512F 100%);
            background-size: 300% auto; /* حجم خلفية كبير للتحريك */
            color: white !important;
            /* --- الشكل الأسطوري والعمق --- */
            border: none;
            padding: 18px 40px; /* حجم كبير وممتلئ */
            font-size: 1.2rem;
            font-weight: 800; /* خط سميك جداً */
            letter-spacing: 1px;
            text-transform: uppercase; /* حروف كبيرة لفرض الهيبة */
            border-radius: 50px; /* شكل كبسولة كامل */
            cursor: pointer;
            position: relative;
            overflow: hidden;
            z-index: 1;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* حركة ناعمة ومرنة */
            /* --- الظلال والتوهج (3D Effect) --- */
            box-shadow: 0 10px 25px rgba(221, 36, 118, 0.5), /* توهج خارجي وردي/ذهبي */
            inset 0 -5px 10px rgba(0, 0, 0, 0.2), /* ظل داخلي سفلي للعمق */
            inset 0 5px 10px rgba(255, 255, 255, 0.4); /* لمعة داخلية علوية */

            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* ظل للنص لجعله يبرز */
        }

            /* تأثير الأيقونة داخل الزر */
            .btn-legendary i {
                margin-left: 10px;
                font-size: 1.3rem;
                transition: transform 0.4s ease;
            }

            /* --- تأثير عند المرور بالماوس (Hover Animation) --- */
            .btn-legendary:hover {
                /* تحريك التدرج اللوني */
                background-position: right center;
                /* رفع الزر للأعلى وتكبيره */
                transform: translateY(-5px) scale(1.05);
                /* زيادة التوهج */
                box-shadow: 0 20px 40px rgba(240, 152, 25, 0.6), inset 0 -5px 10px rgba(0, 0, 0, 0.2);
            }

                .btn-legendary:hover i {
                    /* تدوير وتحريك الأيقونة */
                    transform: rotate(15deg) translateX(-5px) scale(1.2);
                }

        /* --- تأثير النبض المستمر (لجذب الانتباه) --- */
        @keyframes legendaryPulse {
            0% {
                box-shadow: 0 10px 25px rgba(221, 36, 118, 0.5);
            }

            50% {
                box-shadow: 0 15px 35px rgba(240, 152, 25, 0.7);
            }

            100% {
                box-shadow: 0 10px 25px rgba(221, 36, 118, 0.5);
            }
        }

        .btn-legendary {
            animation: legendaryPulse 3s infinite ease-in-out;
        }

        /* تعديل خاص للموبايل لضمان عدم خروج الزر عن الشاشة */
        @media (max-width: 768px) {
            .btn-legendary {
                padding: 15px 25px;
                font-size: 1rem;
                width: 100%; /* يملأ العرض المتاح في الكارد */
            }
        }

        @media (max-width: 768px) {
            .custom-bouquet-card {
                grid-column: 1 / -1; /* هذا السطر يجعله يمتد من بداية الشبكة لنهايتها */
                display: flex;
                flex-direction: row; /* جعل المحتوى يظهر بالعرض ليكون شكله أفضل كعرض خاص */
                align-items: center;
                text-align: right !important;
                height: auto;
            }

                .custom-bouquet-card .img-container {
                    width: 40%; /* تصغير حجم الصورة بجانب النص */
                    height: 150px;
                }

                .custom-bouquet-card .details {
                    width: 60%;
                    padding: 10px;
                }

                .custom-bouquet-card h3 {
                    font-size: 1.1rem;
                    margin-bottom: 5px;
                }

                .custom-bouquet-card .btn-quick-add {
                    padding: 8px;
                    font-size: 0.85rem;
                }
        }

        /* تنسيق زر إفراغ الباقة */
        .btn-reset {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px; /* مسافة بين الأيقونة والنص */
            background-color: transparent;
            color: #a0a0a0; /* لون هادئ في الحالة العادية */
            border: 1.5px solid #e0e0e0;
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            outline: none;
            margin-bottom: 15px;
        }

            /* تأثير عند مرور الماوس (Hover) */
            .btn-reset:hover {
                color: #ff4d4d; /* لون أحمر ناعم عند الرغبة في الحذف */
                border-color: #ff4d4d;
                background-color: rgba(255, 77, 77, 0.05); /* خلفية حمراء شفافة جداً */
                transform: translateY(-1px);
                box-shadow: 0 4px 10px rgba(255, 77, 77, 0.1);
            }

            /* تأثير عند النقر (Active) */
            .btn-reset:active {
                transform: translateY(0);
                background-color: rgba(255, 77, 77, 0.1);
            }

            /* تنسيق خاص للأيقونة داخل الزر */
            .btn-reset i {
                font-size: 0.85rem;
                transition: transform 0.3s ease;
            }

            .btn-reset:hover i {
                transform: rotate(15deg) scale(1.1); /* حركة خفيفة للأيقونة */
            }

        /* تحسين المظهر على الموبايل */
        @media (max-width: 768px) {
            .btn-reset {
                padding: 6px 12px;
                font-size: 0.85rem;
                width: fit-content;
            }
        }


        /* تنسيقات حاوية المصمم */
        .builder-container {
            display: grid;
            grid-template-columns: 1fr 320px;
            gap: 25px;
            align-items: start;
        }

        .bouquet-canvas {
            position: relative;
            width: 100%;
            max-width: 380px;
            height: 450px; /* زيادة الارتفاع ليتناسب مع البوكيه الواقف */
            margin: 0 auto;
            overflow: hidden;
            border: 1px solid #eee;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wrapping-paper-bg {
            position: absolute;
            bottom: 0; /* يبدأ من أسفل الإطار */
            width: 100%;
            height: 100%;
            object-fit: contain; /* لضمان ظهور البوكيه بالكامل دون قص */
            z-index: 1;
        }

        .flowers-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5; /* الورد يظهر فوق ورق التغليف */
        }

        /* تحديث كلاس الوردة داخل الكانفاس */
        .flower-on-canvas {
            position: absolute;
            z-index: 10;
            width: 130px !important;
            touch-action: none; /* يمنع المتصفح من عمل زوم أو سكرول على الوردة */
            user-select: none; /* يمنع تحديد الصورة كنص */
            -webkit-user-select: none;
            cursor: grab;
            /* حركة ناعمة جداً عند تغيير المكان */
            transition: top 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), left 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), transform 0.5s ease;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
            /* نقطة الارتكاز تكون في أسفل الوردة عشان التدوير يكون واقعي */
            transform-origin: bottom center;
        }

            .flower-on-canvas:active {
                cursor: grabbing;
            }

        @keyframes flowerPop {
            0% {
                transform: scale(0) translateY(30px);
                opacity: 0;
            }

            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        /* شبكة خيارات الورد */
        .flower-options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
        }

        .flower-item {
            text-align: center;
            padding: 8px;
            border: 2px solid #f0f0f0;
            border-radius: 15px;
            cursor: pointer;
            background: #fff;
            transition: 0.2s;
        }

            .flower-item:hover {
                border-color: var(--accent-pink);
                background: #fff5f8;
                transform: scale(1.05);
            }

            .flower-item img {
                width: 45px;
                height: 45px;
                object-fit: contain;
                margin-bottom: 5px;
            }

        /* تنسيقات الملخص */
        .bouquet-summary {
            background: #fff;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.05);
            margin-bottom: 15px;
            border: 1px solid #eee;
        }

        .selected-list {
            display: block !important; /* التغيير الأساسي: إظهار القائمة */
            max-height: 120px; /* تحديد ارتفاع أقصى عشان ما تغطي الشاشة */
            overflow-y: auto; /* إضافة سكرول داخلي لو الورد كتير */
            background: #f9f9f9;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
            font-size: 0.85rem;
        }

        .price-section {
            border-top: 2px dashed #eee;
            padding-top: 15px;
            margin-top: 10px;
        }

        .total-box {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--accent-main);
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .builder-container {
                grid-template-columns: 1fr;
            }

            .bouquet-canvas {
                height: 300px;
            }

            .bouquet-summary {
                height: auto;
            }
        }
        /* ==================== إصلاح الفراغ أسفل الصورة في الموبايل ==================== */
        @media (max-width: 768px) {

            /* 1. تقليل ارتفاع مساحة العمل لتناسب الصورة تماماً */
            .bouquet-canvas {
                height: 230px !important; /* قللنا الارتفاع من 280 إلى 230 */
                margin-bottom: 0 !important; /* إزالة أي هوامش سفلية */
            }

            /* 2. إزالة الحشوة السفلية من الحاوية المثبتة */
            .sticky-preview-container {
                padding-bottom: 0 !important; /* إزالة الفراغ السفلي */
                padding-top: 10px !important;
                border-bottom: none !important; /* شكل أنظف بدون خط فاصل */
            }

            /* 3. إجبار صورة التغليف على النزول للأسفل تماماً */
            .wrapping-paper-bg {
                height: 100% !important;
                object-fit: contain !important; /* الحفاظ على أبعاد الصورة */
                object-position: bottom center !important; /* تثبيت الصورة في قاع الصندوق */
            }

            /* تعديل بسيط لمكان الورد عشان يتماشى مع الارتفاع الجديد */
            .flower-on-canvas {
                /* لا تغيير هنا، الحسابات ستتأقلم تلقائياً */
            }
        }

        :root {
            /* 1. تم تعديل لون الخلفية للون الكريمي */
            --bg-body: #f7eedf;
            --bg-card: #ffffff;
            --text-main: #2c1810;
            --text-muted: #8a6d5b;
            --accent-pink: #e75480;
            --accent-purple: #9c27b0;
            --accent-gold: #ffb300;
            --border-color: #f3e5f5;
            --danger-color: #ff4444;
            --gradient-primary: linear-gradient(135deg, #e75480 0%, #9c27b0 100%);
            --gradient-secondary: linear-gradient(135deg, #ffb300 0%, #ff9800 100%);
            --shadow-soft: 0 8px 30px rgba(231, 84, 128, 0.1);
            --shadow-medium: 0 15px 40px rgba(156, 39, 176, 0.15);
        }

        /* ==================== تعديل الخلفية (Bloom Red) ==================== */
        .bloom-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-color: var(--bg-body);
            overflow: hidden;
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(100px); /* ضبابية عالية للنعومة */
            opacity: 0.5; /* شفافية متوسطة */
            animation: floatBlob 15s infinite alternate ease-in-out;
        }

        /* 2. تعديل البقع لتكون تدرجات حمراء خفيفة */
        .blob-1 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, #ffb3c1 0%, rgba(255, 179, 193, 0) 70%); /* أحمر ناعم */
            top: -150px;
            left: -100px;
            animation-duration: 25s;
        }

        .blob-2 {
            width: 500px;
            height: 500px;
            background: radial-gradient(circle, #ffcccb 0%, rgba(255, 204, 203, 0) 70%); /* أحمر مائل للبرتقالي الخافت */
            top: 40%;
            right: -100px;
            animation-duration: 30s;
            animation-delay: -5s;
        }

        .blob-3 {
            width: 700px;
            height: 700px;
            background: radial-gradient(circle, #ffe4e1 0%, rgba(255, 228, 225, 0) 70%); /* وردي محمر فاتح جداً */
            bottom: -200px;
            left: 10%;
            animation-duration: 20s;
            animation-delay: -10s;
        }

        @keyframes floatBlob {
            0% {
                transform: translate(0, 0) scale(1);
            }

            100% {
                transform: translate(50px, 50px) scale(1.1);
            }
        }

        /* ==================== RESET & BASE ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent !important; /* إزالة الوميض الأزرق */
        }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            direction: rtl;
            overflow-x: hidden;
            font-family: 'Cairo', 'Almarai', sans-serif;
            /* === بداية التعديل: خلفية ورقية === */
            background-image:
            /* 1. طبقة ملمس الورق (Pattern) */
            url("https://www.transparenttextures.com/patterns/cream-paper.png"),
            /* 2. طبقة النقاط الخفيفة (اختياري لو عايزة تحافظي عليها) */
            radial-gradient(rgba(231, 84, 128, 0.15) 1px, transparent 1px);
            /* تكرار الخلفية لتملأ الصفحة */
            background-repeat: repeat;
            /* حجم النقاط */
            background-size: auto, 30px 30px;
            /* دمج الطبقات عشان تبان طبيعية */
            background-blend-mode: multiply;
            /* === نهاية التعديل === */
        }

        .container {
            max-width: 1200px;
            margin: auto;
            padding: 0 20px;
        }

        /* ================================================
           توحيد الخط العربي بناءً على تصميم الصورة
           الخط: El Messiri (يشبه خط الصورة)
        ================================================ */
        *:not(i):not(.fa):not(.fas):not(.fab):not(.far):not([class*="material-icons"]) {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
        }

        html {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
        }

        body {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
            font-size: 17px;
            line-height: 1.8;
            text-align: right;
            direction: rtl;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* تحسين العناوين */
        h1, h2, h3, h4, h5, h6 {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
            font-weight: 700;
            line-height: 1.4;
            margin-bottom: 1rem;
        }

        h1 {
            font-size: 2.8rem;
            letter-spacing: -0.5px;
        }

        h2 {
            font-size: 2.2rem;
        }

        h3 {
            font-size: 1.8rem;
        }

        /* النصوص العادية */
        p, span, a, li, div {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
            font-weight: 400;
            letter-spacing: 0.2px;
        }

        /* النصوص السميكة */
        strong, b, .bold-text {
            font-weight: 700 !important;
        }

        /* تحسين الأزرار */
        button, .btn, .btn-hero, .btn-quick-add, .btn-buy-large, .btn-checkout {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
            font-weight: 600 !important;
            letter-spacing: 0.3px;
        }

        /* حقول الإدخال */
        input, textarea, select {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
            font-size: 16px !important;
            font-weight: 400;
        }

        /* الشعار والعناوين الرئيسية */
        .logo-text, .site-title, .hero h1 {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
            font-weight: 800 !important;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        /* البطاقات والمنتجات */
        .product-card, .cat-card, .feature-item, .cart-item {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
        }

        /* الفوتر */
        .site-footer, .footer-bottom {
            font-family: 'El Messiri', 'Noto Sans Arabic', sans-serif !important;
        }

        /* إلغاء أي خطوط سابقة */
        [class*="font-"], [style*="font-family"] {
            font-family: inherit !important;
        }

        /* استثناء الأيقونات فقط */
        i, .fa, .fas, .fab, .far, .material-icons, [class*="icon"] {
            font-family: 'Font Awesome 6 Free', 'FontAwesome' !important;
        }

        /* ==================== ANNOUNCEMENT BAR ==================== */
        .announcement-bar {
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            padding: 8px 0;
            font-size: 0.9rem;
            position: relative;
            z-index: 2;
            box-shadow: 0 2px 10px rgba(231, 84, 128, 0.3);
        }

            .announcement-bar p {
                margin: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 8px;
            }

        /* ==================== NAVBAR ==================== */
        .navbar {
            background: white;
            border-bottom: 1px solid var(--border-color);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-soft);
            backdrop-filter: blur(10px);
        }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .site-logo {
            height: 45px;
            width: auto;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        .nav-center {
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            gap: 25px;
        }

        .nav-link {
            white-space: nowrap;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-main);
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

            .nav-link:hover {
                background: var(--gradient-primary);
                color: white;
                transform: translateY(-2px);
            }

        .search-box {
            width: 100%;
            max-width: 400px;
            position: relative;
        }

            .search-box input {
                width: 100%;
                padding: 12px 45px 12px 20px;
                border: 2px solid #f0f0f0;
                border-radius: 25px;
                background: white;
                outline: none;
                font-size: 0.95rem;
                transition: all 0.3s;
            }

                .search-box input:focus {
                    border-color: var(--accent-pink);
                    box-shadow: 0 0 0 3px rgba(231, 84, 128, 0.1);
                }

            .search-box button {
                position: absolute;
                left: 15px;
                top: 50%;
                transform: translateY(-50%);
                background: none;
                border: none;
                color: var(--accent-pink);
                cursor: pointer;
                font-size: 1.1rem;
            }

        /* ==================== HERO SECTION ==================== */
        .hero {
            text-align: center;
            padding: 100px 20px;
            background: url('https://images.unsplash.com/photo-1519378058457-4c29a0a2efac?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            border-radius: 25px;
            margin: 25px auto;
            position: relative;
            overflow: hidden;
        }

            .hero::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(45deg, rgba(231,84,128,0.1), rgba(156,39,176,0.1));
                z-index: 1;
            }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 700px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.5rem;
            color: var(--text-main);
            margin-bottom: 20px;
            font-weight: 800;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-muted);
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .btn-hero {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(231, 84, 128, 0.3);
        }

            .btn-hero:hover {
                transform: translateY(-3px) scale(1.05);
                box-shadow: 0 15px 40px rgba(231, 84, 128, 0.4);
            }

        /* ==================== CATEGORIES ==================== */
        .categories-section {
            margin: 60px 0;
        }

        .section-title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 40px;
            color: var(--text-main);
            position: relative;
            display: inline-block;
            left: 50%;
            transform: translateX(-50%);
        }

            .section-title::after {
                content: '';
                position: absolute;
                bottom: -10px;
                left: 50%;
                transform: translateX(-50%);
                width: 100px;
                height: 4px;
                background: var(--gradient-primary);
                border-radius: 2px;
            }

        .categories-wrapper {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .cat-card {
            width: 150px;
            height: 180px;
            background: white;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-soft);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

            .cat-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 5px;
                background: var(--gradient-primary);
                transform: scaleX(0);
                transition: transform 0.3s ease;
            }

            .cat-card:hover::before {
                transform: scaleX(1);
            }

            .cat-card:hover {
                transform: translateY(-10px);
                box-shadow: var(--shadow-medium);
                border-color: var(--accent-pink);
            }

            .cat-card.active {
                border-color: var(--accent-pink);
                background: linear-gradient(135deg, #fff9f9 0%, #fff 100%);
            }

        .cat-img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            margin-bottom: 15px;
            transition: transform 0.3s ease;
        }

        .cat-card:hover .cat-img {
            transform: scale(1.1) rotate(5deg);
        }

        .cat-card span {
            font-weight: 600;
            color: var(--text-main);
            font-size: 1rem;
        }

        /* ==================== PRODUCTS ==================== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }
        /* للشاشات الصغيرة (موبايل) */
        @media (max-width: 768px) {
            .products-grid {
                /* هنا التعديل الرئيسي */
                grid-template-columns: repeat(2, 1fr); /* عمودين متساويين */
                gap: 15px; /* مسافة أقل بين المنتجات */
            }

            .product-card {
                margin: 0; /* إزالة الهوامش الإضافية */
                min-height: auto; /* السماح بارتفاع تلقائي */
            }
        }

        /* للشاشات الصغيرة جداً (أقل من 480px) */
        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr); /* يبقى عمودين */
                gap: 10px; /* مسافة أقل */
            }
        }

        .product-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--shadow-soft);
            position: relative;
        }



        .product-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--gradient-primary);
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }

        .img-container {
            width: 100%;
            height: 250px;
            overflow: hidden;
            background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 100%);
            position: relative;
        }

            .img-container img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transition: transform 0.6s ease;
            }


        /* 1. تعديل الطبقة لتكون شفافة تماماً بدون أي لون أو تغبيش */
        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent !important; /* إلغاء اللون الوردي */
            backdrop-filter: none !important; /* إلغاء التغبيش */
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0; /* مخفي افتراضياً */
            transition: opacity 0.3s ease;
            z-index: 5;
        }


        /* 2. تحسين تصميم الزر ليكون واضحاً جداً فوق الصورة */
        .quick-view-btn {
            background: #ffffff;
            color: var(--accent-pink); /* لون النص وردي */
            border: 2px solid var(--accent-pink); /* إطار وردي لتمييز الزر */
            padding: 10px 24px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 0.95rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* ظل قوي للزر */
            transform: translateY(10px); /* يبدأ من أسفل قليلاً */
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }




        .details {
            padding: 20px;
        }

            .details h3 {
                font-size: 1.1rem;
                margin-bottom: 10px;
                color: var(--text-main);
                font-weight: 700;
            }

        .price {
            font-size: 1.4rem;
            color: var(--accent-pink);
            font-weight: 800;
            margin-bottom: 15px;
            display: block;
        }



        /* ==================== FEATURES ==================== */
        .features-section {
            margin: 80px 0;
        }

        .features-wrapper {
            background: white;
            border-radius: 25px;
            padding: 60px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            box-shadow: var(--shadow-medium);
            position: relative;
            overflow: hidden;
        }

            .features-wrapper::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 5px;
                background: var(--gradient-primary);
            }

        .features-image {
            border-radius: 15px;
            overflow: hidden;
        }

            .features-image img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transition: transform 0.6s ease;
            }

        .features-wrapper:hover .features-image img {
            transform: scale(1.05);
        }

        .feature-item {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

            .feature-item:hover {
                background: rgba(231, 84, 128, 0.05);
                transform: translateX(-10px);
            }

        .icon-box {
            width: 60px;
            height: 60px;
            background: var(--gradient-primary);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

            .icon-box i {
                color: white;
                font-size: 1.5rem;
            }

        /* ==================== FOOTER ==================== */
        .site-footer {
            background: linear-gradient(135deg, #2c1810 0%, #1a0f0a 100%);
            color: white;
            padding: 60px 0 20px;
            margin-top: 80px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-logo {
            height: 50px;
            margin-bottom: 20px;
            filter: brightness(0) invert(1);
        }

        .delivery-alert {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-right: 4px solid var(--accent-pink);
            margin-top: 20px;
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

            .social-icon:hover {
                background: var(--gradient-primary);
                transform: translateY(-3px);
            }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
        }

        /* ==================== MODALS & SIDEBARS ==================== */
        .modal {
            display: none;
            position: fixed;
            z-index: 99999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            backdrop-filter: blur(5px);
        }

            .modal.show-modal {
                display: flex;
                align-items: center;
                justify-content: center;
                animation: fadeIn 0.3s ease;
            }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 25px;
            max-width: 500px;
            width: 90%;
            position: relative;
            animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .close-btn {
            position: absolute;
            left: 20px;
            top: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-muted);
            transition: color 0.3s ease;
        }

            .close-btn:hover {
                color: var(--accent-pink);
            }

        /* ==================== CART SIDEBAR ==================== */
        .cart-sidebar {
            position: fixed;
            top: 0;
            left: -450px;
            width: 450px;
            height: 100%;
            background: white;
            box-shadow: -5px 0 30px rgba(0,0,0,0.1);
            z-index: 10000;
            transition: left 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            flex-direction: column;
        }

            .cart-sidebar.active {
                left: 0;
            }

        .cart-header {
            padding: 25px;
            background: var(--gradient-primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .cart-footer {
            padding: 25px;
            border-top: 1px solid var(--border-color);
        }

        .btn-checkout {
            width: 100%;
            padding: 18px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 15px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

            .btn-checkout:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 25px rgba(231, 84, 128, 0.3);
            }

        /* ==================== ANIMATIONS ==================== */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        .floating {
            animation: float 3s ease-in-out infinite;
        }

        /* ==================== RESPONSIVE ==================== */
        @media (max-width: 992px) {
            .features-wrapper {
                grid-template-columns: 1fr;
            }

            .hero h1 {
                font-size: 2.8rem;
            }
        }

        @media (max-width: 768px) {
            .nav-link {
                display: none;
            }

            .nav-center {
                justify-content: flex-end;
            }

            .hero {
                padding: 60px 20px;
            }

                .hero h1 {
                    font-size: 2.2rem;
                }

            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 20px;
            }

            .features-wrapper {
                padding: 30px;
            }

            .cart-sidebar {
                width: 100%;
                left: -100%;
            }
        }

        @media (max-width: 480px) {
            .categories-wrapper {
                justify-content: center;
            }

            .cat-card {
                width: 130px;
                height: 160px;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .section-title {
                font-size: 1.6rem;
            }
        }

        /* ==================== UTILITY CLASSES ==================== */
        .hidden {
            display: none !important;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 9999;
            display: none;
        }

            .overlay.active {
                display: block;
            }

        .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-pink);
            color: white;
            font-size: 0.7rem;
            font-weight: bold;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
        }

        .mobile-bottom-nav {
            display: none;
        }

        @media (max-width: 768px) {
            .mobile-bottom-nav {
                display: flex;
                justify-content: space-around;
                align-items: center;
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 70px;
                background: white;
                border-top: 1px solid var(--border-color);
                z-index: 1000;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            }

            body {
                padding-bottom: 70px;
            }
        }

        /* ==================== تصميم التوست ميسدج الجديد (Pop-up) ==================== */
        #toast {
            position: fixed;
            top: 25px; /* مسافة من الأعلى */
            left: 50%;
            /* البداية: مرفوع للأعلى ومخفي */
            transform: translateX(-50%) translateY(-100px) scale(0.8);
            /* تصميم زجاجي (Glassmorphism) */
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 12px 30px;
            border-radius: 50px; /* شكل كبسولة */
            /* ظل ناعم */
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 100000; /* فوق كل العناصر */

            opacity: 0;
            visibility: hidden;
            /* أنيميشن مطاطي (Bouncy) */
            transition: all 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

            /* كلاس التفعيل */
            #toast.show {
                transform: translateX(-50%) translateY(0) scale(1);
                opacity: 1;
                visibility: visible;
            }

            /* أيقونة التوست */
            #toast i {
                color: #4caf50; /* أخضر نقي لعلامة الصح */
                font-size: 1.3rem;
                background: #e8f5e9;
                width: 30px;
                height: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
            }

            /* نص التوست */
            #toast span {
                color: #333;
                font-weight: 600;
                font-size: 0.95rem;
                font-family: 'El Messiri', sans-serif;
            }


        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* ==================== PRODUCT VIEW PAGE ==================== */
        .product-view {
            padding: 40px 0;
            min-height: 100vh;
            background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 100%);
        }

        .product-details-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            background: white;
            padding: 40px;
            border-radius: 25px;
            box-shadow: var(--shadow-medium);
        }

        .product-gallery {
            position: sticky;
            top: 100px;
        }

        .main-img {
            width: 100%;
            height: 400px;
            border-radius: 20px;
            overflow: hidden;
            background: linear-gradient(135deg, #fce4ec 0%, #f3e5f5 100%);
            margin-bottom: 20px;
        }

            .main-img img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                transition: transform 0.6s ease;
            }

            .main-img:hover img {
                transform: scale(1.05);
            }

        .small-imgs {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

            .small-imgs img {
                width: 80px;
                height: 80px;
                border-radius: 10px;
                object-fit: cover;
                cursor: pointer;
                border: 2px solid transparent;
                transition: all 0.3s ease;
            }

                .small-imgs img.active {
                    border-color: var(--accent-pink);
                }

        .product-info h2 {
            font-size: 2.2rem;
            color: var(--text-main);
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .price-box {
            font-size: 2.5rem;
            color: var(--accent-pink);
            font-weight: 800;
            margin: 25px 0;
            display: flex;
            align-items: baseline;
            gap: 5px;
        }

        .currency {
            font-size: 1.2rem;
            color: var(--text-muted);
        }

        .description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-muted);
            margin-bottom: 30px;
        }

        .btn-buy-large {
            width: 100%;
            padding: 20px;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
        }

            .btn-buy-large:hover {
                transform: translateY(-3px);
                box-shadow: 0 15px 30px rgba(231, 84, 128, 0.3);
            }

        .features-list {
            list-style: none;
            margin-top: 30px;
        }

            .features-list li {
                margin-bottom: 15px;
                display: flex;
                align-items: center;
                gap: 10px;
                color: var(--text-muted);
            }

            .features-list i {
                color: var(--accent-pink);
                font-size: 1.2rem;
            }

        @media (max-width: 768px) {
            .product-details-container {
                grid-template-columns: 1fr;
                padding: 20px;
                gap: 30px;
            }

            .product-gallery {
                position: static;
            }

            .main-img {
                height: 300px;
            }

            .product-info h2 {
                font-size: 1.8rem;
            }

            .price-box {
                font-size: 2rem;
            }
        }

        /* رفع القسم للأعلى */
        .raised-section {
            margin-top: -60px;
            position: relative;
            z-index: 10;
        }

        /* تحسين شكل صور الورد */
        .cat-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #fff;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 10px;
            transition: transform 0.3s ease;
        }

        /* تأثير عند المرور بالماوس */
        .cat-card:hover .cat-img {
            transform: scale(1.1);
            border-color: #ff6b6b;
        }

        @media (max-width: 768px) {
            .img-container {
                height: 180px; /* تصغير ارتفاع الصورة */
            }

            .product-card h3 {
                font-size: 0.9rem; /* تصغير حجم النص */
                margin-bottom: 8px;
            }

            .price {
                font-size: 1.1rem; /* تصغير السعر */
                margin-bottom: 10px;
            }

            .btn-quick-add {
                padding: 10px; /* تصغير الأزرار */
                font-size: 0.9rem;
            }

            .product-badge {
                font-size: 0.7rem; /* تصغير البادجات */
                padding: 4px 8px;
                top: 10px;
                right: 10px;
            }
        }
        /* تصميم الإشعار الجديد */
        #toast {
            position: fixed;
            top: 20px;
            left: 50%;
            /* يبدأ مخفياً ومرفوعاً للأعلى */
            transform: translateX(-50%) translateY(-100px) scale(0.9);
            /* شكل زجاجي وعصري */
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 12px 25px;
            border-radius: 50px; /* كبسولة كاملة */
            /* ظل ناعم وفخم */
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.5);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 100000;
            opacity: 0;
            visibility: hidden;
            /* هذا هو سر الانسيابية (Slight Bounce Effect) */
            transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

            /* حالة الظهور */
            #toast.show {
                transform: translateX(-50%) translateY(20px) scale(1); /* ينزل للأسفل مع تكبير طبيعي */
                opacity: 1;
                visibility: visible;
            }

            /* تنسيق الأيقونة داخل التوست */
            #toast i {
                font-size: 1.2rem;
                color: #4caf50; /* أخضر نقي لعلامة الصح */
                background: #e8f5e9;
                padding: 5px;
                border-radius: 50%;
            }

            /* تنسيق النص */
            #toast span {
                font-family: 'El Messiri', sans-serif;
                font-weight: 600;
                color: #333;
                font-size: 0.95rem;
            }
        /* ==================== زر الإضافة الجديد (ستايل أوتلاين) ==================== */
        .btn-quick-add {
            width: 100%;
            padding: 10px 20px;
            /* 1. جعل الخلفية شفافة لعمل الاوتلاين */
            background: transparent;
            /* 2. لون الخط والحدود (Outline) */
            color: #e75480; /* نفس درجة الوردي */
            border: 2px solid #e75480;
            border-radius: 50px; /* حواف دائرية كاملة لشكل أفخم */
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            /* فليكس لضبط الأيقونة والنص */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            /* أنيميشن ناعم للرجوع للحالة الأصلية */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

            /* تأثير عند مرور الماوس (يتحول لممتلئ) */
            .btn-quick-add:hover {
                background: #e75480;
                color: white;
                border-color: #e75480;
                transform: translateY(-3px); /* يرتفع للأعلى قليلاً */
                box-shadow: 0 5px 15px rgba(231, 84, 128, 0.3); /* ظل ناعم */
            }

            /* حل مشكلة التعليق: تأثير لحظة الضغط فقط */
            .btn-quick-add:active {
                transform: scale(0.95); /* تصغير الزر لحظياً */
                background: #c2185b; /* لون أغمق عند الضغط */
                border-color: #c2185b;
                box-shadow: none !important; /* إخفاء الظل ليبدو واقعياً */
            }

            /* هام جداً: إزالة تأثير التركيز اللي بيخلي الزر "معلق" */
            .btn-quick-add:focus {
                outline: none; /* إزالة البرواز الأزرق الافتراضي */
                /* نعيد الألوان لطبيعتها لو المستخدم شال صباعه */
            }
        /* للشاشات الصغيرة (موبايل) */
        @media (max-width: 768px) {
            .products-grid {
                /* هنا التعديل الرئيسي */
                grid-template-columns: repeat(2, 1fr); /* عمودين متساويين */
                gap: 15px; /* مسافة أقل بين المنتجات */
            }

            .product-card {
                margin: 0; /* إزالة الهوامش الإضافية */
                min-height: auto; /* السماح بارتفاع تلقائي */
            }
        }

        /* للشاشات الصغيرة جداً (أقل من 480px) */
        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr); /* يبقى عمودين */
                gap: 10px; /* مسافة أقل */
            }
        }

        /* ==================== MOBILE BOTTOM NAV IMPROVEMENT ==================== */
        .mobile-bottom-nav {
            display: none;
        }

        @media (max-width: 768px) {
            .mobile-bottom-nav {
                display: flex;
                justify-content: space-around;
                align-items: center;
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 75px; /* زيادة الارتفاع قليلاً */
                background: linear-gradient(135deg, #ffffff 0%, #fafafa 100%);
                border-top: 1px solid rgba(231, 84, 128, 0.2);
                z-index: 1000;
                box-shadow: 0 -10px 30px rgba(156, 39, 176, 0.15);
                padding: 0 10px;
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
                border-top-left-radius: 25px;
                border-top-right-radius: 25px;
            }

            body {
                padding-bottom: 85px; /* زيادة المسافة لأسفل */
            }

            .nav-item {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                text-decoration: none;
                color: var(--text-muted);
                font-size: 0.75rem;
                font-weight: 500;
                flex: 1;
                height: 100%;
                transition: all 0.3s ease;
                position: relative;
                padding: 8px 0;
                border-radius: 12px;
                margin: 0 3px;
            }

                .nav-item.active {
                    color: var(--accent-pink);
                    background: rgba(231, 84, 128, 0.08);
                    transform: translateY(-5px);
                }

                .nav-item:hover {
                    color: var(--accent-pink);
                    transform: translateY(-2px);
                }

                .nav-item i {
                    font-size: 1.3rem;
                    margin-bottom: 4px;
                    transition: all 0.3s ease;
                }

                .nav-item.active i {
                    transform: scale(1.1);
                    color: var(--accent-pink);
                }

                .nav-item span {
                    font-size: 0.7rem;
                    font-weight: 600;
                    letter-spacing: 0.3px;
                    transition: all 0.3s ease;
                }

                /* تأثير عند النقر */
                .nav-item:active {
                    transform: scale(0.95);
                }

                /* علامة للمنشط */
                .nav-item.active::after {
                    content: '';
                    position: absolute;
                    top: -3px;
                    width: 30px;
                    height: 3px;
                    background: var(--gradient-primary);
                    border-radius: 3px;
                }

                /* إضافة أيقونة السلة مع العداد */
                .nav-item:has(i.fa-shopping-basket) {
                    position: relative;
                }

            .cart-counter-mobile {
                position: absolute;
                top: 5px;
                right: calc(50% - 25px);
                background: var(--accent-pink);
                color: white;
                font-size: 0.65rem;
                font-weight: bold;
                width: 18px;
                height: 18px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                border: 2px solid white;
                box-shadow: 0 2px 5px rgba(231, 84, 128, 0.3);
            }

            /* تأثيرات خاصة للأيقونات */
            .nav-item i.fa-home {
                color: var(--accent-purple);
            }

            .nav-item i.fa-shopping-basket {
                color: var(--accent-pink);
            }

            .nav-item i.fa-heart {
                color: #ff6b8b;
            }

            .nav-item i.fa-user {
                color: #9c27b0;
            }

            /* تحسين للشاشات الصغيرة جداً */
            @media (max-width: 380px) {
                .mobile-bottom-nav {
                    height: 70px;
                }

                .nav-item i {
                    font-size: 1.2rem;
                }

                .nav-item span {
                    font-size: 0.65rem;
                }

                body {
                    padding-bottom: 80px;
                }
            }

            /* تأثيرات الحركة */
            @keyframes navPulse {
                0%, 100% {
                    transform: scale(1);
                }

                50% {
                    transform: scale(1.05);
                }
            }

            .nav-item.pulse {
                animation: navPulse 0.5s ease;
            }
        }

        /* ==================== إضافة تأثيرات للهواتف فقط ==================== */
        @media (hover: hover) and (pointer: fine) {
            .nav-item:hover {
                background: rgba(231, 84, 128, 0.05);
            }
        }

        /* دعم اللمس بشكل أفضل */
        @media (max-width: 768px) {
            .nav-item {
                -webkit-tap-highlight-color: transparent;
                user-select: none;
                -webkit-user-select: none;
            }

                /* تحسين للمساحة القابلة للنقر */
                .nav-item::before {
                    content: '';
                    position: absolute;
                    top: -10px;
                    left: 0;
                    right: 0;
                    height: 50px;
                    background: transparent;
                }
        }

        /* ==================== تعديلات الموبايل (اللوجو والسيرش في سطر واحد) ==================== */
        @media (max-width: 768px) {

            /* 1. إخفاء زر السلة من الأعلى تماماً */
            .cart-btn {
                display: none !important;
            }

            /* 2. جعل المحتوى في سطر واحد وتنسيق المسافات */
            .nav-content {
                display: flex;
                flex-direction: row; /* سطر واحد */
                align-items: center;
                justify-content: space-between;
                gap: 10px; /* مسافة بين اللوجو والسيرش */
                padding: 5px 10px;
            }

            /* 3. تنسيق اللوجو ليكون بحجم مناسب */
            .logo-link {
                flex: 0 0 auto; /* اللوجو يأخذ مساحته فقط ولا يتمدد */
            }

            .site-logo {
                height: 30px; /* تصغير اللوجو قليلاً ليناسب السطر */
                width: auto;
            }

            /* 4. جعل صندوق البحث يملأ المساحة المتبقية */
            .nav-center {
                flex: 1; /* السيرش يأخذ باقي مساحة السطر */
                display: block;
                margin: 0;
            }

            .search-box {
                width: 100%;
                max-width: none;
            }

                .search-box input {
                    padding: 8px 35px 8px 10px; /* تقليل الحشو الداخلي */
                    height: 38px; /* ارتفاع مناسب للسطر */
                    font-size: 0.8rem;
                    border-radius: 20px;
                }

                /* موازنة أيقونة البحث */
                .search-box button {
                    left: 10px;
                    font-size: 0.9rem;
                }

            /* إخفاء الروابط النصية (الرئيسية) لأنها في الشريط السفلي */
            .nav-link {
                display: none !important;
            }
        }

        /* ==================== التصميم النهائي الثابت للموبايل ==================== */
        @media (max-width: 768px) {

            /* 1. المودال يغطي الشاشة بالكامل بدون سكرول خارجي */
            #bouquetBuilderModal .modal-content {
                width: 100% !important;
                height: 100vh !important;
                max-height: 100vh !important;
                border-radius: 0;
                padding: 0;
                background: #f8f9fa;
                display: flex;
                flex-direction: column;
                overflow: hidden; /* يمنع الصفحة كلها من الحركة */
            }

            /* تنسيق العنوان */
            .modal-title {
                position: absolute;
                top: 15px;
                width: 100%;
                text-align: center;
                margin: 0;
                z-index: 60;
                font-size: 1rem;
                pointer-events: none;
            }

            /* حاوية التصميم */
            .builder-container {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow: hidden;
            }

            /* ================= الجزء العلوي (الثابت) ================= */
            .visual-preview-side {
                flex: 0 0 auto; /* ارتفاع ثابت حسب المحتوى ولا ينكمش */
                background: #ffffff;
                padding-top: 50px; /* مساحة للعنوان وزر الغلق */
                padding-bottom: 10px;
                border-bottom: 1px solid #eee;
                box-shadow: 0 4px 10px rgba(0,0,0,0.05);
                z-index: 50;
                position: relative;
            }

            .bouquet-canvas {
                height: 280px !important; /* ارتفاع الصورة */
                width: 100%;
                max-width: 300px;
                margin: 0 auto;
                background: transparent !important;
                border: none;
            }

            /* ================= الجزء السفلي (المتحرك رأسياً) ================= */
            .scrollable-content {
                flex: 1; /* يأخذ باقي المساحة المتاحة */
                overflow-y: auto; /* يسمح بالسكرول الرأسي هنا فقط */
                padding: 15px;
                padding-bottom: 80px; /* مساحة عشان تضمن إن آخر زرار يبان */
            }

            /* صندوق الورود */
            .flower-selection-wrapper {
                background: #fff;
                padding: 15px 10px;
                border-radius: 15px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.03);
                margin-bottom: 20px;
            }

            /* شريط الورود الأفقي (Horizontal Scroll) */
            .flower-options-grid {
                display: flex !important;
                flex-wrap: nowrap !important;
                overflow-x: auto !important;
                gap: 10px;
                padding: 5px 0;
                overscroll-behavior-x: contain; /* يفصل حركة اليمين/اليسار عن الصفحة */
                scrollbar-width: none;
            }

                .flower-options-grid::-webkit-scrollbar {
                    display: none;
                }

            /* كارت الوردة */
            .flower-item {
                flex: 0 0 auto;
                width: 80px;
                height: 110px;
                border: 1px solid #eee;
                border-radius: 12px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                transition: transform 0.1s;
            }

                .flower-item:active {
                    transform: scale(0.95);
                    background: #fafafa;
                }

                .flower-item img {
                    width: 50px;
                    height: 50px;
                    object-fit: contain;
                    margin-bottom: 5px;
                }

                .flower-item h5 {
                    font-size: 0.7rem;
                    margin: 0;
                    color: #555;
                    width: 100%;
                    text-align: center;
                    overflow: hidden;
                    white-space: nowrap;
                    text-overflow: ellipsis;
                }

            /* صندوق الملخص */
            .bouquet-summary {
                background: #fff;
                padding: 20px;
                border-radius: 15px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.03);
                height: auto;
            }

            .selected-list {
                display: none;
            }
            /* إخفاء الليست الطويلة */

            /* زر الإغلاق */
            .close-btn {
                position: fixed;
                top: 15px;
                left: 20px;
                z-index: 100;
                background: rgba(255,255,255,0.9);
                width: 35px;
                height: 35px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
        }

        /* ==================== تنسيق مودال صانع الباقات (Clean & Fixed) ==================== */

        /* 1. المودال الأساسي */
        #bouquetBuilderModal .modal-content {
            background-color: #f8f9fa;
            width: 95%;
            max-width: 1000px;
            height: 90vh; /* ارتفاع مبدئي للديسك توب */
            padding: 0;
            border-radius: 20px;
            overflow: hidden; /* مهم جداً */
            display: flex;
            flex-direction: column;
        }

        /* زر الإغلاق */
        #bouquetBuilderModal .close-btn {
            position: absolute;
            top: 15px;
            left: 20px;
            z-index: 100;
            background: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
        }

        /* الهيدر */
        .modal-header {
            text-align: center;
            padding: 15px;
            background: white;
            border-bottom: 1px solid #eee;
            flex-shrink: 0; /* ممنوع الانكماش */
        }

            .modal-header h2 {
                margin: 0;
                font-size: 1.2rem;
                color: var(--accent-pink);
            }

        /* الجسم الرئيسي (Layout) */
        .builder-layout {
            display: flex;
            flex: 1; /* يأخذ باقي المساحة */
            overflow: hidden; /* يمنع السكرول الخارجي */
        }

        /* ==================== تصميم الموبايل (الأسطوري) ==================== */
        @media (max-width: 768px) {

            /* جعل المودال يملأ الشاشة */
            #bouquetBuilderModal .modal-content {
                width: 100% !important;
                height: 100vh !important;
                max-height: 100vh !important;
                border-radius: 0;
            }

            /* تحويل اللي-أوت لعمود واحد */
            .builder-layout {
                flex-direction: column;
                overflow-y: auto; /* هنا السكرول الرئيسي للصفحة */
                scroll-behavior: smooth;
            }

            /* القسم البصري (الصورة + الورد) */
            .visual-section {
                display: flex;
                flex-direction: column;
            }

            /* 1. تثبيت الصورة (Sticky Preview) */
            .sticky-preview-container {
                position: sticky;
                top: 0;
                z-index: 50;
                background: #ffffff;
                padding: 10px 0;
                border-bottom: 1px solid #f0f0f0;
                box-shadow: 0 4px 15px rgba(0,0,0,0.03);
            }

            .bouquet-canvas {
                height: 280px; /* ارتفاع ثابت للصورة */
                width: 100%;
                margin: 0 auto;
                border: none;
                background: transparent;
            }

            /* 2. شريط الورد (Horizontal Scroll Box) */
            .flowers-scroll-container {
                background: white;
                margin: 15px;
                padding: 15px;
                border-radius: 15px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.05);
                position: relative;
                z-index: 40;
            }

                .flowers-scroll-container h4 {
                    margin: 0 0 10px 0;
                    font-size: 0.9rem;
                    color: #555;
                }

            /* القائمة الأفقية */
            .horizontal-scroll-list {
                display: flex;
                overflow-x: auto;
                gap: 12px;
                padding-bottom: 5px;
                overscroll-behavior-x: contain; /* يفصل سكرول الورد عن الصفحة */
                scrollbar-width: none; /* إخفاء البار لفايرفوكس */
            }

                .horizontal-scroll-list::-webkit-scrollbar {
                    display: none;
                }
            /* لكروم */

            /* كارت الوردة */
            .flower-item {
                flex: 0 0 auto; /* حجم ثابت */
                width: 80px;
                height: 110px;
                border: 1px solid #eee;
                border-radius: 12px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                background: #fff;
            }

                .flower-item img {
                    width: 45px;
                    height: 45px;
                    object-fit: contain;
                    margin-bottom: 5px;
                }

                .flower-item h5 {
                    font-size: 0.7rem;
                    margin: 0;
                    text-align: center;
                    width: 100%;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .flower-item div {
                    font-size: 0.8rem;
                    font-weight: bold;
                    color: var(--accent-pink);
                }

            /* 3. قسم الملخص (أسفل الصفحة) */
            .summary-section {
                padding: 0 15px 40px 15px; /* مسافة سفلية */
            }

            .bouquet-summary {
                background: white;
                border-radius: 15px;
                padding: 20px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            }

            /* إخفاء القائمة الطويلة في الموبايل */
            .selected-list {
                display: none;
            }

            /* أزرار التحكم في السعر */
            .price-actions {
                display: flex;
                flex-direction: column;
                gap: 15px;
            }

            .price-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                border-bottom: 1px dashed #eee;
                padding-bottom: 15px;
            }

            .total-price {
                font-size: 1.1rem;
                font-weight: 800;
                color: var(--accent-pink);
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
            }

            .btn-buy-large {
                width: 100%;
                padding: 15px;
                font-size: 1rem;
            }
        }
        /* داخل الميديا كويري للموبايل */
        @media (max-width: 768px) {

            /* 1. زيادة المساحة السفلية لضمان ظهور السعر فوق الزر */
            .controls-section {
                padding-bottom: 150px !important; /* هذه هي المساحة التي ستدفع المحتوى للأعلى */
            }

            /* 2. تحسين مكان صندوق السعر */
            .bouquet-summary {
                margin-bottom: 20px !important;
                position: relative;
                z-index: 5; /* لضمان ظهوره بشكل صحيح */
            }

            /* 3. التأكد من أن الزر ثابت في الأسفل ولا يغطي المحتوى بشكل خاطئ */
            .btn-buy-large {
                position: fixed !important;
                bottom: 0 !important;
                left: 0 !important;
                width: 100% !important;
                margin: 0 !important;
                border-radius: 20px 20px 0 0 !important; /* تدوير الحواف العلوية فقط */
                z-index: 100 !important;
                padding: 15px !important;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.1) !important;
            }
        }
        /* ==================== تنسيق الديسك توب (عشان ما يضربش) ==================== */
        @media (min-width: 769px) {
            .builder-layout {
                flex-direction: row;
                padding: 20px;
                gap: 20px;
                overflow-y: auto;
            }

            .visual-section {
                flex: 1;
                display: flex;
                flex-direction: column;
                gap: 20px;
            }

            .sticky-preview-container {
                border-radius: 15px;
                overflow: hidden;
                border: 1px solid #eee;
            }

            .bouquet-canvas {
                height: 400px;
            }

            /* في الديسك توب، الورود تكون شبكة عادية مش سكرول */
            .horizontal-scroll-list {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
                gap: 10px;
            }

            .flower-item {
                padding: 10px;
                cursor: pointer;
                transition: 0.3s;
            }


            .summary-section {
                width: 300px;
                flex-shrink: 0;
            }

            .bouquet-summary {
                background: white;
                padding: 20px;
                border-radius: 15px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.05);
                height: 100%;
            }
        }

        /* ==================== إصلاح صفحة الدفع للموبايل ==================== */
        @media (max-width: 768px) {

            /* 1. تحويل الشبكة الرئيسية لعمود واحد بدلاً من عمودين */
            .product-details-container {
                grid-template-columns: 1fr !important; /* إلغاء الـ 350px الثابتة */
                gap: 20px !important;
                padding: 10px;
            }

            /* 2. جعل ملخص الحساب يأخذ العرض الكامل */
            .checkout-summary-side {
                width: 100%;
                margin-top: 20px;
                order: -1; /* (اختياري) لو عايز الملخص يظهر قبل الفورم، لو مش عايز احذف السطر ده */
            }

            /* 3. إصلاح خانة "طريقة الدفع" و "تاريخ التوصيل" ليظهروا فوق بعض */
            /* نستهدف الـ div الذي يحتوي على grid داخل الفورم */
            #orderForm > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important; /* تحويل لعمود واحد */
            }

            /* 4. تحسين شكل حقول الإدخال للموبايل */
            input, select, textarea {
                font-size: 16px !important; /* يمنع الزووم التلقائي في الآيفون */
                padding: 14px !important; /* تكبير منطقة اللمس */
            }

            /* 5. زر الواتساب */
            .btn-buy-large {
                width: 100%;
                padding: 15px;
                font-size: 1.1rem;
                position: fixed; /* (اختياري) لتثبيت الزر أسفل الشاشة */
                bottom: 0;
                left: 0;
                right: 0;
                border-radius: 0 !important;
                z-index: 1000;
                box-shadow: 0 -5px 15px rgba(0,0,0,0.1);
            }

            /* إضافة مسافة سفلية عشان الزر المثبت ميغطيش المحتوى */
            #checkoutSection {
                margin-bottom: 80px !important;
            }
        }

        @media (max-width: 768px) {
            /* تنسيق الشبكة والنصوص */
            .footer-grid {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 30px;
            }

            /* فاصل للأقسام ما عدا الأخير (وفرنا كود الحذف) */
            .footer-col:not(:last-child) {
                border-bottom: 1px solid rgba(255,255,255,0.1);
                padding-bottom: 30px;
            }

            /* صندوق التوصيل */
            .delivery-alert {
                display: flex;
                flex-direction: column;
                width: 90%;
                margin: 15px auto;
                padding: 15px;
                background: rgba(255,255,255,0.05);
                border-radius: 15px;
            }

                .delivery-alert i {
                    color: var(--accent-pink);
                    font-size: 1.5rem;
                    margin-bottom: 8px;
                }

            /* الروابط والفواصل بينها */
            .footer-links li {
                width: 80%;
                margin: 0 auto;
            }

                .footer-links li:not(:last-child) {
                    border-bottom: 1px dashed rgba(255,255,255,0.05);
                    padding-bottom: 10px;
                    margin-bottom: 10px;
                }

            /* السوشيال ميديا */
            .social-links {
                justify-content: center;
                margin-top: 20px;
            }

            .social-icon {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }
        }
        /* ==================== تأثيرات النص السحرية (Hero Text) ==================== */

        /* 1. تنسيق العنوان الرئيسي (H1) - لمعان وتوهج */
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 900; /* خط عريض جداً عشان التأثير يبان */
            margin-bottom: 20px;
            /* جعل النص متدرجاً (أبيض + وردي فاتح جداً) */
            background: linear-gradient( to right, #ffffff 0%, #ffc3d9 20%, #ffffff 40%, #ffffff 100% );
            background-size: 200% auto;
            /* قص الخلفية على شكل النص */
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            /* أنيميشن تحريك اللمعة */
            animation: shineEffect 3s linear infinite;
            /* ظل متوهج حول النص (Glow) */
            filter: drop-shadow(0 0 10px rgba(231, 84, 128, 0.6));
        }

        /* 2. تنسيق الوصف (P) - أبيض ناصع مع وضوح عالي */
        .hero p {
            font-size: 1.3rem;
            color: #ffffff; /* أبيض صريح */
            line-height: 1.8;
            font-weight: 600;
            max-width: 700px;
            margin: 0 auto 30px;
            /* ظل أسود ناعم خلف الكلام عشان يتقرأ بوضوح فوق أي صورة */
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            /* تأثير زجاجي خفيف خلف النص (اختياري، بيخلي شكله شيك) */
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(2px);
            padding: 10px 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: inline-block; /* عشان الخلفية تكون على قد الكلام بس */
        }

        /* 3. تعريف حركة اللمعان */
        @keyframes shineEffect {
            to {
                background-position: 200% center;
            }
        }

        /* تحسين للموبايل */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.2rem;
            }

            .hero p {
                font-size: 1rem;
                padding: 10px;
            }
        }

        /* ==================== 1. تنسيقات كارت الإهداء ==================== */
        .gift-card-container {
            position: absolute;
            top: 50px; /* مكان الكارت المبدئي */
            left: 50%;
            transform: translateX(-50%) rotate(-5deg);
            width: 140px;
            height: 100px;
            background: #fffdf9; /* لون ورق كريمي */
            border: 1px solid #e0e0e0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 20; /* يظهر فوق الورد */
            padding: 10px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Great Vibes', 'Marhey', cursive; /* خط اليد */
            font-size: 1.1rem;
            color: #4a4a4a;
            border-radius: 5px;
            overflow: hidden;
            cursor: grab;
            background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png'); /* ملمس ورق */
        }

        /* ==================== 2. تنسيقات الوضع الليلي الرومانسي ==================== */
        body.dark-mode {
            --bg-body: #0f172a; /* كحلي غامق جداً */
            --bg-card: rgba(30, 41, 59, 0.7); /* زجاجي غامق */
            --text-main: #f8fafc;
            --text-muted: #cbd5e1;
            --border-color: #334155;
            background-image: radial-gradient(#1e293b 1px, transparent 1px);
        }

            /* تعديلات خاصة للوضع الليلي */
            body.dark-mode .navbar,
            body.dark-mode .cart-sidebar,
            body.dark-mode .product-page-header,
            body.dark-mode .sticky-preview-container,
            body.dark-mode .visual-preview-side {
                background: rgba(15, 23, 42, 0.9) !important;
                border-color: #334155 !important;
            }

            body.dark-mode .product-card,
            body.dark-mode .cat-card,
            body.dark-mode .flower-item,
            body.dark-mode .bouquet-summary,
            body.dark-mode .flowers-scroll-container,
            body.dark-mode .flower-selection-wrapper {
                background: rgba(30, 41, 59, 0.6) !important;
                border-color: #334155 !important;
                color: white;
            }

            /* توهج خافت للورد في الوضع الليلي */
            body.dark-mode .flower-on-canvas,
            body.dark-mode .img-container img {
                filter: drop-shadow(0 0 8px rgba(231, 84, 128, 0.3));
            }

            body.dark-mode .blob {
                opacity: 0.2; /* تقليل سطوع الخلفية */
            }

        /* زر الوضع الليلي */
        .theme-toggle-btn {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-main);
            transition: transform 0.3s;
        }

            .theme-toggle-btn:hover {
                transform: rotate(20deg);
            }

        /* ==================== 3. زر تحميل الصورة ==================== */
        .btn-download {
            background: #6c5ce7;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
            width: 100%;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(108, 92, 231, 0.3);
        }

            .btn-download:hover {
                background: #5a4bcf;
            }

        /* ==================== إصلاح شكل المنتجات (الكمبيوتر والموبايل) ==================== */

        /* تنسيق الشبكة (الكمبيوتر: 4 في السطر / الموبايل: 2 في السطر) */
        .products-grid {
            display: grid !important;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)) !important;
            gap: 25px !important;
            padding: 20px 0;
            width: 100%;
        }

        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr) !important; /* عمودين للموبايل */
                gap: 10px !important;
                padding: 0 10px;
            }
        }

        /* تنسيق الكارت ليكون بحجم مظبوط */
        .product-card {
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid #eee;
            display: flex;
            flex-direction: column;
            height: 100%; /* ارتفاع كامل */
            transition: transform 0.3s ease-out, box-shadow 0.3s ease !important;
        }

        /* تنسيق الصورة لمنعها من أن تكون عملاقة */
        .img-container {
            width: 100%;
            height: 250px !important; /* ارتفاع ثابت للكمبيوتر */
            overflow: hidden;
            background: #f9f9f9;
        }

            .img-container img {
                width: 100%;
                height: 100%;
                object-fit: cover; /* ملء الإطار دون تمطيط */
                transition: 0.5s;
            }

        @media (max-width: 768px) {
            .img-container {
                height: 150px !important; /* ارتفاع أصغر للموبايل */
            }
        }

        /* تنسيق التفاصيل */
        .details {
            padding: 15px;
            display: flex;
            flex-direction: column;
            flex: 1;
        }

            .details h3 {
                font-size: 1.1rem;
                margin-bottom: 10px;
            }

        /* البحث عن هذا الكلاس وتعديله */
        .product-card {
            /* تغيير الـ cubic-bezier ليكون ease-out لراحة العين */
            transition: transform 0.3s ease-out, box-shadow 0.3s ease !important;
        }


        /* تنسيق كارت صمم باقتك في الموبايل */
        @media (max-width: 768px) {
            .custom-bouquet-card {
                grid-column: 1 / -1 !important;
                display: flex !important;
                flex-direction: row !important;
                height: auto !important;
            }

                .custom-bouquet-card .img-container {
                    width: 40% !important;
                    height: 120px !important;
                }

                .custom-bouquet-card .details {
                    width: 60% !important;
                }
        }

        /* ==================== 1. تصميم زر قائمة الأمنيات (القلب) ==================== */
        .btn-love {
            width: 42px;
            height: 42px;
            border-radius: 50%; /* شكل دائري */
            background: #fff;
            border: 1px solid #eee;
            color: #ccc; /* لون رمادي باهت في الحالة العادية */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

            /* عند مرور الماوس */
            .btn-love:hover {
                border-color: #ff4757;
                color: #ff4757;
                background: #fff0f3;
                transform: translateY(-3px) scale(1.1);
                box-shadow: 0 5px 15px rgba(255, 71, 87, 0.2);
            }

            /* عند التفعيل (لما المنتج ينضاف للمفضلة) */
            .btn-love.active {
                background: #ff4757;
                color: white;
                border-color: #ff4757;
                animation: heartPulse 0.6s;
            }

        /* أنيميشن النبض */
        @keyframes heartPulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.4);
            }

            100% {
                transform: scale(1);
            }
        }

        /* ==================== 2. رفع الكروت للأعلى (Higher Overlay Cards) ==================== */
        .product-card {
            /* إضافة transition ناعم جداً */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.4s ease !important;
        }



        /* 1. تعديل الطبقة لتكون شفافة تماماً بدون أي لون أو تغبيش */
        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent !important; /* إلغاء اللون الوردي */
            backdrop-filter: none !important; /* إلغاء التغبيش */
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0; /* مخفي افتراضياً */
            transition: opacity 0.3s ease;
            z-index: 5;
        }



        /* 2. تحسين تصميم الزر ليكون واضحاً جداً فوق الصورة */
        .quick-view-btn {
            background: #ffffff;
            color: var(--accent-pink); /* لون النص وردي */
            border: 2px solid var(--accent-pink); /* إطار وردي لتمييز الزر */
            padding: 10px 24px;
            border-radius: 50px;
            font-weight: 800;
            font-size: 0.95rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* ظل قوي للزر */
            transform: translateY(10px); /* يبدأ من أسفل قليلاً */
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* حركة ظهور الزر */



        /* ==================== تحديث شكل الموبايل (أعرض وأقصر) ==================== */
        @media (max-width: 768px) {

            /* 1. إعدادات الشبكة: تقليل الفراغات لزيادة عرض الكارت */
            .products-grid {
                grid-template-columns: repeat(2, 1fr) !important; /* عمودين */
                gap: 8px !important; /* مسافة ضيقة جداً بين الكارتين */
                padding: 0 5px !important; /* مسافة صغيرة من حواف الشاشة */
                margin: 15px 0 !important;
            }

            /* 2. كارت المنتج: إلغاء أي هوامش خارجية */
            .product-card {
                width: 100% !important;
                margin: 0 !important;
                border-radius: 12px !important; /* تدوير حواف أقل لتوفير مساحة */
            }

                .product-card .img-container {
                    height: 220px !important;
                }

                /* 4. التفاصيل: ضغط المسافات الداخلية */
                .product-card .details {
                    padding: 8px 6px !important; /* حشوة صغيرة جداً */
                    gap: 4px !important; /* مسافة بين العناصر */
                }

                /* 5. النصوص: تصغير الحجم */
                .product-card h3 {
                    font-size: 0.8rem !important;
                    margin-bottom: 2px !important;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .product-card .price {
                    font-size: 0.95rem !important;
                    margin-bottom: 5px !important;
                }

            /* 6. الأزرار: جعلها مدمجة */
            .buttons-wrapper {
                gap: 5px !important;
                margin-top: 2px !important;
            }

            .btn-quick-add {
                padding: 4px 0 !important; /* زر رفيع */
                font-size: 0.75rem !important;
                height: 30px !important;
                border-radius: 8px !important;
            }

            .btn-love {
                width: 30px !important;
                height: 30px !important;
                font-size: 0.9rem !important;
                border-radius: 8px !important;
            }

            /* === تنسيق كارت "صمم باقتك" ليملأ العرض === */
            .custom-bouquet-card {
                grid-column: 1 / -1 !important;
                display: flex !important;
                flex-direction: row !important;
                /* غير الرقم ده من 110px لـ 140px */
                height: 140px !important;
                margin-bottom: 5px !important;
            }

                .custom-bouquet-card .img-container {
                    width: 35% !important;
                    height: 100% !important;
                    border-radius: 0 !important; /* إلغاء التدوير عشان يملأ الجنب */
                }

                .custom-bouquet-card .details {
                    width: 65% !important;
                    padding: 10px !important;
                    display: flex !important;
                    flex-direction: column !important;
                    justify-content: center !important;
                }

                .custom-bouquet-card h3 {
                    font-size: 1rem !important;
                    white-space: normal !important; /* السماح بالنص ينزل سطرين هنا */
                }

                .custom-bouquet-card p {
                    display: none !important; /* إخفاء الوصف لتوفير مساحة */
                }

                .custom-bouquet-card .btn-legendary {
                    padding: 8px 15px !important;
                    font-size: 0.8rem !important;
                    margin-top: 5px !important;
                }
        }
        /* ==================== تحديث الموبايل (عريض ومستغل للمساحة) ==================== */
        @media (max-width: 768px) {

            /* 1. توسيع الحاوية الرئيسية (أهم خطوة) */
            .container {
                padding: 0 5px !important; /* تقليل الهوامش الجانبية من 20px لـ 5px */
                width: 100% !important;
                max-width: 100% !important;
            }

            /* 2. ضبط الشبكة لتملأ العرض بالكامل */
            .products-grid {
                grid-template-columns: repeat(2, 1fr) !important; /* عمودين متساويين */
                gap: 6px !important; /* مسافة رفيعة جداً بين المنتجات */
                padding: 0 !important; /* إلغاء حشو الشبكة الداخلي */
                margin: 15px 0 !important;
            }

            /* 3. كارت المنتج */
            .product-card {
                width: 100% !important;
                margin: 0 !important;
                border-radius: 10px !important;
            }

                .product-card .img-container {
                    height: 220px !important;
                }


                /* 5. ضغط التفاصيل الداخلية لتوفير مساحة */
                .product-card .details {
                    padding: 8px 5px !important;
                    gap: 3px !important;
                }

            /* ... (باقي الأكواد كما هي) ... */

            /* === تنسيق كارت "صمم باقتك" ليملأ العرض === */
            .custom-bouquet-card {
                grid-column: 1 / -1 !important;
                display: flex !important;
                flex-direction: row !important;
                height: 140px !important; /* تم التعديل من 110 إلى 140 ليتناسب مع الطول الجديد */
                margin-bottom: 5px !important;
            }

            .product-card .img-container {
                height: 220px !important;
            }

                .product-card .img-container img {
                    /* 1. contain: تجعل الصورة تظهر بالكامل دون قص (تصغير الزووم) */
                    object-fit: contain !important;
                    /* 2. padding: يضيف مسافة بيضاء حول الوردة ليبدو حجمها أصغر */
                    padding: 8px !important;
                    /* تحسين جودة العرض */
                    width: 100% !important;
                    height: 100% !important;
                }
            /* 5. ضغط التفاصيل الداخلية لتوفير مساحة */
            .product-card .details {
                padding: 8px 5px !important;
                gap: 3px !important;
            }

            /* 6. تصغير الخطوط لتتناسب مع العرض الجديد */
            .product-card h3 {
                font-size: 0.8rem !important;
                margin-bottom: 2px !important;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .product-card .price {
                font-size: 0.9rem !important;
                margin-bottom: 5px !important;
            }

            /* 7. الأزرار */
            .buttons-wrapper {
                gap: 4px !important;
                margin-top: 2px !important;
            }

            .btn-quick-add {
                padding: 0 !important;
                font-size: 0.7rem !important;
                height: 30px !important;
                border-radius: 8px !important;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .btn-love {
                width: 30px !important;
                height: 30px !important;
                font-size: 0.9rem !important;
                border-radius: 8px !important;
            }

            /* === تنسيق كارت "صمم باقتك" ليملأ العرض === */
            .custom-bouquet-card {
                grid-column: 1 / -1 !important;
                display: flex !important;
                flex-direction: row !important;
                height: 110px !important;
                margin-bottom: 5px !important;
            }

                .custom-bouquet-card .img-container {
                    width: 35% !important;
                    height: 100% !important;
                }

                .custom-bouquet-card .details {
                    width: 65% !important;
                    padding: 10px !important;
                }

                .custom-bouquet-card h3 {
                    font-size: 1rem !important;
                    white-space: normal !important;
                }

                .custom-bouquet-card p {
                    display: none !important;
                }
        }

        /* ==================== تصميم الكارت الأسطوري (نسخة الكمبيوتر) ==================== */
        .legendary-card {
            /* خلفية متدرجة غنية */
            background: linear-gradient(135deg, #FF512F 0%, #DD2476 50%, #ff7675 100%) !important;
            border: none !important; /* إلغاء الحدود القديمة */
            color: white !important;
            position: relative;
            overflow: hidden;
            /* ظل ملون ومضيء */
            box-shadow: 0 15px 35px rgba(221, 36, 118, 0.3), 0 5px 15px rgba(0,0,0,0.1) !important;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
            display: flex !important;
            flex-direction: column; /* نعود للشكل العمودي في الكمبيوتر */
        }

            /* تأثير التوهج عند المرور */
            .legendary-card:hover {
                transform: translateY(-10px) scale(1.02) !important;
                box-shadow: 0 25px 50px rgba(221, 36, 118, 0.5) !important;
            }

            /* طبقة إضاءة خلفية */
            .legendary-card .glow-effect {
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 60%);
                opacity: 0;
                transition: opacity 0.5s;
                pointer-events: none;
                mix-blend-mode: overlay;
            }

            .legendary-card:hover .glow-effect {
                opacity: 1;
            }

        /* الشارة الجديدة */
        .legendary-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            color: #fff;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            border: 1px solid rgba(255, 255, 255, 0.3);
            z-index: 2;
            display: flex;
            align-items: center;
            gap: 5px;
        }

            .legendary-badge i {
                color: #ffd700;
            }
        /* لون ذهبي للنجمة */

        /* تنسيق الصورة داخل الكارت الأسطوري */
        .legendary-card .img-container {
            height: 220px !important;
            background: transparent !important; /* خلفية شفافة */
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .legendary-card .img-container img {
                max-height: 100%;
                width: auto;
                filter: drop-shadow(0 10px 20px rgba(0,0,0,0.2)); /* ظل للصورة نفسها */
                transition: transform 0.5s;
            }

        .legendary-card:hover .img-container img {
            transform: scale(1.1) rotate(-3deg); /* حركة بسيطة للصورة */
        }

        /* النصوص */
        .legendary-card .details {
            text-align: center;
            padding: 25px !important;
            background: transparent !important;
        }

        .legendary-card h3 {
            font-size: 1.8rem !important;
            margin-bottom: 10px !important;
            color: white !important;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .legendary-card p {
            color: rgba(255,255,255,0.9) !important;
            font-size: 1rem;
            margin-bottom: 25px;
            display: block !important; /* التأكد من ظهوره في الكمبيوتر */
        }

        /* الزر الأسطوري */
        .btn-legendary-action {
            background: white;
            color: #DD2476;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            width: auto;
            justify-content: center;
        }

            .btn-legendary-action:hover {
                transform: translateY(-3px);
                box-shadow: 0 10px 25px rgba(0,0,0,0.3);
                background: #fff;
                color: #FF512F;
            }

            .btn-legendary-action .btn-icon {
                background: linear-gradient(135deg, #FF512F, #DD2476);
                color: white;
                width: 35px;
                height: 35px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 0.9rem;
            }

        /* ==================== تحديث الموبايل للكارت الأسطوري ==================== */
        @media (max-width: 768px) {
            /* ... (باقي أكواد الموبايل السابقة تبقى كما هي) ... */

            /* تنسيق الكارت الأسطوري في الموبايل (جانبي لتقليل الارتفاع) */
            .legendary-card {
                grid-column: 1 / -1 !important; /* عرض كامل */
                display: flex !important;
                flex-direction: row !important; /* صورة بجانب النص */
                height: auto !important;
                min-height: 130px; /* ارتفاع مناسب */
                align-items: center !important;
                padding: 0 !important;
            }

                /* تعديل حجم الصورة ومكانها */
                .legendary-card .img-container {
                    width: 35% !important;
                    height: 130px !important;
                    padding: 10px !important;
                }

                    .legendary-card .img-container img {
                        filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2));
                    }

                /* تعديل النصوص والزر */
                .legendary-card .details {
                    width: 65% !important;
                    padding: 15px 10px !important;
                    text-align: right !important; /* محاذاة لليمين في الموبايل */
                    display: flex !important;
                    flex-direction: column !important;
                    justify-content: center !important;
                    align-items: flex-start !important;
                }

                .legendary-card h3 {
                    font-size: 1.2rem !important;
                    margin-bottom: 5px !important;
                    white-space: normal !important; /* السماح بالنزول لسطرين */
                }

                /* إخفاء الوصف في الموبايل لتوفير المساحة (اختياري) */
                .legendary-card p {
                    display: none !important;
                }

            /* تصغير الزر */
            .btn-legendary-action {
                padding: 8px 15px !important;
                font-size: 0.9rem !important;
                margin-top: 8px !important;
                width: 100%; /* زر بعرض المساحة المتاحة */
            }

                .btn-legendary-action .btn-text {
                    flex: 1;
                    text-align: center;
                }

            .legendary-badge {
                top: 10px;
                left: auto;
                right: 10px; /* نقل الشارة لليمين */
                padding: 3px 8px;
                font-size: 0.7rem;
            }
        }

        /* ==================== تحسين وتلخيص الفوتر للموبايل ==================== */
        @media (max-width: 768px) {
            .site-footer {
                padding: 30px 0 90px 0; /* مسافة سفلية عشان الناف بار المثبت */
                text-align: center;
            }

            .footer-grid {
                gap: 25px; /* تقليل المسافات بين الأقسام */
            }

            /* 1. تنسيق العنوان وصندوق التوصيل ليكون في المنتصف */
            .delivery-alert {
                width: 100%;
                margin: 10px 0;
                justify-content: center;
                text-align: center;
            }

            /* إصلاح العنوان (بما أنه مكتوب بستايل داخلي، نحتاج لتعديله هنا) */
            .footer-col div[style*="display: flex"] {
                flex-direction: column !important;
                align-items: center !important;
                text-align: center !important;
            }

                .footer-col div[style*="display: flex"] i {
                    margin: 0 0 10px 0 !important;
                    font-size: 1.5rem !important;
                }

            /* 2. تحويل القوائم الطويلة إلى شبكة (زرارين في السطر) لتوفير المساحة */
            .footer-links {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 10px;
                padding: 0;
            }

                .footer-links li {
                    width: 100%;
                    margin: 0;
                    border: none !important; /* إزالة الخطوط الفاصلة */
                    padding: 0;
                }

                /* شكل الزر للروابط */
                .footer-links a {
                    display: block;
                    background: rgba(255, 255, 255, 0.05);
                    padding: 10px;
                    border-radius: 8px;
                    font-size: 0.9rem;
                    transition: 0.2s;
                }

            /* 3. تنسيق السوشيال ميديا */
            .social-links {
                justify-content: center;
                gap: 20px;
                margin-bottom: 0;
            }

            /* 4. إخفاء الوصف الطويل في الموبايل (اختياري - للتلخيص) */
            /* إذا كنت تريد إظهاره، احذف هذا الجزء */
            .footer-col > p {
                font-size: 0.85rem;
                margin: 0 0 15px 0 !important;
                opacity: 0.7;
            }
        }
        /* ==================== إصلاح إحساس الضغط (Feedback) ==================== */

        /* تأثير الانكماش عند اللمس للأزرار والكروت */
        button:active,
        a:active,
        .btn:active,
        .cat-card:active,
        .product-card:active,
        .nav-item:active,
        .flower-item:active,
        .design-item:active,
        .btn-love:active,
        .btn-quick-add:active {
            transform: scale(0.96) !important; /* تصغير طفيف */
            transition: transform 0.1s ease !important; /* استجابة فورية */
            opacity: 0.9;
        }

        /* تأثير خاص لقوائم الاختيار (Select) وحقول الإدخال */
        select:focus, input:focus, textarea:focus {
            background-color: #fff5f8 !important; /* خلفية وردية فاتحة جداً عند الكتابة */
            border-color: var(--accent-pink) !important;
            box-shadow: 0 0 0 3px rgba(231, 84, 128, 0.1) !important;
        }

        /* ==================== تعديل لون زر الإضافة عند الضغط (أخضر) ==================== */
        .btn-quick-add:active {
            /* لون أخضر زاهي */
            background: #22c55e !important;
            /* إزالة أي تدرج لوني قديم (الأصفر) */
            background-image: none !important;
            border-color: #16a34a !important;
            color: white !important;
            /* تأثير الانكماش الذي أضفناه سابقاً */
            transform: scale(0.95) !important;
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.4) !important; /* ظل أخضر خفيف */
        }

        /* ==================== إصلاح زر الواتساب (إلغاء التثبيت) ==================== */
        @media (max-width: 768px) {

            /* 1. استهداف الزرار داخل فورم الدفع عشان نرجعه لطبيعته */
            #orderForm .btn-buy-large {
                position: relative !important; /* كان fixed ودلوقتي خليناه نسبي */
                bottom: auto !important;
                left: auto !important;
                right: auto !important;
                width: 100% !important;
                border-radius: 15px !important; /* نرجع الحواف الدائرية */
                margin-top: 25px !important; /* مسافة تفصله عن الحقول اللي فوقه */
                margin-bottom: 10px !important;
                /* تحسين الظل ليكون أخضر يليق بالواتساب */
                box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3) !important;
                z-index: 1 !important; /* إلغاء الطبقة العالية */
            }

            /* 2. إزالة المسافة الكبيرة اللي كنا سايبينها تحت عشان الزرار المثبت */
            #checkoutSection {
                margin-bottom: 30px !important; /* تقليل المسافة لتكون طبيعية */
            }
        }

        /* تعريف الأنيميشن السلس */
        @keyframes smoothUp {
            0% {
                opacity: 0;
                transform: translateY(50px); /* يبدأ من أسفل بـ 50 بكسل */
            }

            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* الكلاس الذي سنستخدمه */
        .smooth-entry {
            animation-name: smoothUp;
            animation-duration: 0.8s; /* مدة أطول قليلاً للنعومة */
            animation-timing-function: cubic-bezier(0.22, 1, 0.36, 1); /* سر النعومة (توقف تدريجي) */
            animation-fill-mode: both;
        }

        /* تنسيق شريط الأزرار الموحد */
        .product-actions-bar {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-top: 30px;
        }

        /* زر القلب الكبير بجانب زر الشراء */
        .btn-love-large {
            width: 60px;
            height: 56px; /* نفس ارتفاع زر الشراء */
            border-radius: 15px;
            border: 2px solid #eee;
            background: white;
            color: #ccc;
            font-size: 1.4rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0; /* يمنع انكماش الزر */
        }

            .btn-love-large:hover {
                border-color: #ff4757;
                color: #ff4757;
                background: #fff0f3;
            }

            .btn-love-large.active {
                background: #ff4757;
                color: white;
                border-color: #ff4757;
                animation: heartPulse 0.6s;
            }

        /* زر الشراء يأخذ باقي المساحة */
        .product-actions-bar .btn-buy-large {
            flex: 1;
            margin: 0; /* إزالة الهوامش الخارجية */
            height: 56px; /* توحيد الارتفاع */
        }

        /* ==================== تنسيق الموبايل (منظم وثابت) ==================== */
        @media (max-width: 768px) {
            /* تحسين قائمة المميزات في الموبايل */
            .features-list {
                background: #f9f9f9;
                padding: 15px;
                border-radius: 15px;
                margin-bottom: 100px; /* مسافة عشان الأزرار متغطيش عليها */
            }

                .features-list li {
                    font-size: 0.9rem;
                    margin-bottom: 10px;
                }

            /* تثبيت شريط الأزرار أسفل الشاشة */
            .product-actions-bar {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: white;
                padding: 15px 20px;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.1); /* ظل علوي ناعم */
                z-index: 1000; /* يظهر فوق كل شيء */
                margin: 0;
                border-top-left-radius: 20px;
                border-top-right-radius: 20px;
            }
        }

        /* ==================== تحسين صفحة المنتج للموبايل (Mobile Product View) ==================== */

        @media (max-width: 768px) {

            /* 1. ضبط حاوية الصفحة والمحتوى */
            #fullProductPage {
                background-color: #ffffff !important;
                /* إضافة مساحة سفلية كبيرة عشان الأزرار المثبتة متغطي شعلى الكلام */
                padding-bottom: 120px !important;
            }

            /* تحويل العرض لعمود واحد بدلاً من عمودين */
            .product-details-container #fullPageContent {
                display: flex !important;
                flex-direction: column !important;
                gap: 0 !important;
                padding: 0 !important;
            }

            /* 2. تنسيق صورة المنتج (كبيرة وواضحة) */
            .main-img {
                width: 100% !important;
                height: 380px !important; /* ارتفاع مناسب للموبايل */
                border-radius: 0 0 30px 30px !important; /* تدوير الحواف من الأسفل فقط */
                margin-bottom: 20px !important;
                box-shadow: 0 10px 30px rgba(0,0,0,0.08) !important;
                position: relative;
            }

            /* 3. تنسيق معلومات المنتج (العنوان والسعر) */
            .product-info {
                padding: 0 20px !important; /* حشوة جانبية للنصوص */
            }

                .product-info h2 {
                    font-size: 1.6rem !important; /* تكبير العنوان */
                    margin-bottom: 5px !important;
                }

            .price-box {
                font-size: 1.8rem !important;
                margin: 10px 0 !important;
                color: var(--accent-pink);
            }

            /* 4. تنسيق الوصف وقائمة المميزات */
            .description {
                font-size: 0.95rem !important;
                color: #666 !important;
                line-height: 1.6 !important;
                margin-bottom: 20px !important;
            }

            .features-list {
                background-color: #f9f9f9 !important;
                padding: 15px !important;
                border-radius: 15px !important;
                margin-top: 10px !important;
            }

            /* 5. تثبيت شريط الأزرار أسفل الشاشة (تم الإصلاح) */
            .product-actions-bar {
                position: fixed !important;
                bottom: 0 !important;
                left: 0 !important;
                width: 100% !important;
                background: white !important;
                padding: 15px 20px !important;
                /* ظل علوي لتمييز الشريط */
                box-shadow: 0 -5px 20px rgba(0,0,0,0.1) !important;
                /* تنسيق الفليكس لضمان المحاذاة */
                display: flex !important;
                flex-direction: row !important; /* سطر واحد إجباري */
                align-items: center !important;
                justify-content: space-between !important;
                gap: 12px !important; /* مسافة بين الزر والقلب */

                z-index: 9999 !important; /* رقم عالي جداً ليظهر فوق كل شيء */
                /* تدوير الحواف العلوية للشريط */
                border-radius: 25px 25px 0 0 !important;
                border-top: 1px solid #eee !important;
            }

                /* تنسيق زر الشراء الكبير داخل الشريط */
                .product-actions-bar .btn-buy-large {
                    flex: 1 !important; /* يأخذ المساحة المتبقية */
                    margin: 0 !important;
                    height: 55px !important;
                    font-size: 1.1rem !important;
                    border-radius: 15px !important;
                    box-shadow: 0 5px 15px rgba(231, 84, 128, 0.4) !important;
                }
        }

        /* ==================== الناف بار الأسطوري (نسخة 2.0 - Grid System) ==================== */
        @media (max-width: 768px) {

            /* 1. الحاوية الأساسية: تثبيت وتأثير الزجاج */
            .navbar {
                height: 90px; /* زيادة الارتفاع ليتناسب مع اللوجو الكبير */
                padding: 0 !important;
                background: rgba(255, 255, 255, 0.90) !important;
                backdrop-filter: blur(20px) !important;
                border-bottom: 1px solid rgba(0,0,0,0.05);
                display: flex;
                align-items: center;
            }

            /* 2. تقسيم العناصر بنظام الشبكة (Grid) */
            .nav-content {
                display: grid !important;
                /* تقسيم المساحة: اللوجو (تلقائي) | السيرش (الباقي) | زر الثيم (تلقائي) */
                grid-template-columns: auto 1fr auto !important;
                align-items: center !important;
                gap: 15px !important;
                width: 100%;
                padding: 0 15px !important;
            }

            /* 3. اللوجو (تم تكبيره) */
            .logo-link {
                display: flex;
                align-items: center;
            }

            .site-logo {
                height: 70px !important; /* تكبير اللوجو ليصبح 70 بكسل */
                width: auto !important;
                object-fit: contain; /* الحفاظ على أبعاد الصورة */
                filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
            }

            /* 4. السيرش بار (كومباكت وأنيق) */
            .nav-center {
                margin: 0 !important;
                display: block !important;
                width: 100%;
            }

            .nav-link {
                display: none !important;
            }

            .search-box {
                width: 100% !important;
                max-width: 100% !important;
                height: 40px;
                position: relative;
            }

                .search-box input {
                    width: 100% !important;
                    height: 100% !important;
                    background: #f3f5f7 !important;
                    border: 1px solid transparent !important;
                    border-radius: 12px !important;
                    padding: 0 10px 0 35px !important;
                    font-size: 0.8rem !important;
                    color: #333;
                    transition: all 0.3s ease;
                    text-align: right;
                }

                    .search-box input:focus {
                        background: #ffffff !important;
                        border-color: var(--accent-pink) !important;
                        box-shadow: 0 4px 15px rgba(231, 84, 128, 0.1);
                    }

                .search-box button {
                    position: absolute;
                    left: 8px !important;
                    top: 50% !important;
                    transform: translateY(-50%) !important;
                    background: none;
                    border: none;
                    color: #999;
                    padding: 0;
                    font-size: 1rem !important;
                }

            /* 5. زر الثيم (الوضع الليلي) */
            .theme-toggle-btn {
                width: 42px;
                height: 42px;
                background: white !important;
                border: 1px solid #eee !important;
                border-radius: 12px !important;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 4px 12px rgba(0,0,0,0.05);
                color: #333;
                transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
                margin: 0 !important;
            }

                .theme-toggle-btn:active {
                    transform: scale(0.9);
                    background: #f9f9f9 !important;
                }

                .theme-toggle-btn i {
                    font-size: 1.2rem;
                    color: var(--text-main);
                }

            .cart-btn {
                display: none !important;
            }
        }

        /* ==================== تحسينات صفحة الشحن وملخص السلة ==================== */

        /* 1. الحاوية الرئيسية (تأثير الزجاج) */
        #checkoutSection .product-details-container {
            background: rgba(255, 255, 255, 0.85) !important;
            backdrop-filter: blur(15px) !important;
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 20px 50px rgba(0,0,0,0.05);
            border-radius: 25px;
            padding: 40px !important;
            animation: fadeInUp 0.6s ease-out;
        }

        /* 2. تحسين حقول الإدخال (Inputs) */
        #orderForm input,
        #orderForm select,
        #orderForm textarea {
            background-color: #f8f9fa !important;
            border: 2px solid #f0f0f0 !important;
            border-radius: 12px !important;
            padding: 15px !important;
            font-size: 0.95rem !important;
            transition: all 0.3s ease;
            color: var(--text-main);
        }

            /* تأثير عند الكتابة داخل الحقل */
            #orderForm input:focus,
            #orderForm select:focus,
            #orderForm textarea:focus {
                background-color: #fff !important;
                border-color: var(--accent-pink) !important;
                box-shadow: 0 0 0 4px rgba(231, 84, 128, 0.1) !important;
                transform: translateY(-2px);
            }

        /* تسميات الحقول (Labels) */
        #orderForm label {
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 8px;
            display: block;
            font-size: 0.9rem;
        }

        /* 3. تحسين ملخص السلة (الكارت الجانبي) */
        .checkout-summary-side {
            background: #fff !important;
            border-radius: 20px !important;
            padding: 25px !important;
            border: 1px solid #f0f0f0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.03) !important;
            position: sticky;
            top: 110px; /* تثبيت الملخص أثناء النزول في الكمبيوتر */
            height: fit-content;
        }

            /* عنوان الملخص */
            .checkout-summary-side h3 {
                font-size: 1.2rem;
                color: var(--text-main);
                border-bottom: 2px dashed #eee;
                padding-bottom: 15px;
                margin-bottom: 20px;
                text-align: center;
            }

        /* 4. تحسين قائمة المنتجات داخل الملخص */
        #checkoutItemsList {
            background: #fafafa;
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 20px;
            max-height: 350px;
            overflow-y: auto;
        }

            /* تصميم العنصر الواحد في القائمة */
            #checkoutItemsList > div {
                background: white;
                padding: 12px;
                margin-bottom: 8px;
                border-radius: 10px;
                border: 1px solid #eee;
                display: flex;
                justify-content: space-between;
                align-items: center;
                transition: 0.2s;
                font-size: 0.9rem;
            }

                #checkoutItemsList > div:last-child {
                    margin-bottom: 0;
                }

                #checkoutItemsList > div:hover {
                    transform: translateX(-3px);
                    border-color: var(--accent-pink);
                }

        /* 5. تحسين عرض الإجمالي */
        #checkoutSection .total-price-box {
            background: linear-gradient(135deg, #fce4ec 0%, #fff 100%);
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(231, 84, 128, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 800;
            font-size: 1.2rem;
            color: var(--text-main);
        }

        #finalTotalAmount {
            color: var(--accent-pink);
            font-size: 1.4rem;
        }

        /* 6. تحسين زر التأكيد (واتساب) */
        .btn-whatsapp-confirm {
            background: linear-gradient(45deg, #25d366, #128c7e);
            color: white;
            font-weight: 800;
            font-size: 1.1rem;
            padding: 18px;
            border-radius: 15px;
            border: none;
            width: 100%;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

            .btn-whatsapp-confirm:hover {
                transform: translateY(-3px);
                box-shadow: 0 15px 35px rgba(37, 211, 102, 0.4);
            }

        /* أنيميشن الظهور */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ==================== تعديلات الموبايل ==================== */
        @media (max-width: 768px) {
            #checkoutSection .product-details-container {
                padding: 20px !important;
                gap: 20px !important;
            }

            .checkout-summary-side {
                position: relative;
                top: 0;
                margin-top: 20px;
                order: -1; /* رفع الملخص فوق الفورم في الموبايل ليرى العميل المبلغ أولاً */
            }

            /* جعل زر التأكيد يطفو أسفل الشاشة في الموبايل */
            .btn-whatsapp-confirm {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                border-radius: 20px 20px 0 0;
                z-index: 1000;
                padding: 15px;
                margin: 0;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            }

            /* مسافة سفلية عشان الزر العائم */
            #checkoutSection {
                padding-bottom: 80px;
            }
        }
    </style>
</head>
<body>

    <div class="bloom-background">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>


    <!-- Announcement Bar -->
    <div class="announcement-bar">
        <div class="container">
            <p>
                <i class="fas fa-shipping-fast"></i>
                توصيل سريع للورود في أقل من ساعتين
            </p>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-content">
            <a href="#" class="logo-link" onclick="goHome()">
                <img src="https://i.postimg.cc/43TtXHVJ/b6021d2c-01cd-479a-82aa-74411a18fe96.png" alt="Bloom Elite" class="site-logo">
            </a>

            <div class="nav-center">
                <a href="#" class="nav-link" onclick="goHome()">الرئيسية</a>
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="ابحث عن الورود التي تحبها...">
                    <button><i class="fas fa-search"></i></button>
                    <div id="searchResults" class="search-results-dropdown"></div>
                </div>

            <div class="cart-btn" onclick="openCart()">
                <i class="fas fa-shopping-basket"></i>
                <span class="badge">0</span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="animate__animated animate__fadeInDown">ورود تعبر عن مشاعرك</h1>
                <p class="animate__animated animate__fadeInUp animate__delay-1s">
                    اختار من تشكيلتنا الفريدة من الورود الطازجة والمصممة بدقة، كل باقة تحمل قصة وكل وردة تعبر عن مشاعر
                </p>

                <img src="https://i.postimg.cc/fRhb2V5f/file.jpg"
                     alt="Rose Garden Logo"
                     class="hero-logo animate__animated animate__zoomIn animate__delay-0.3s">
            </div>
        </div>
    </section>

    <!-- Categories -->
    <section class="container categories-section raised-section">
        <div class="categories-wrapper">
            <div class="cat-card active floating" onclick="filterByCategory('all')">
                <img src="https://images.unsplash.com/photo-1526047932273-341f2a7631f9?q=80&w=200&h=200&auto=format&fit=crop" alt="الكل" class="cat-img">
                <span>جميع الورود</span>
            </div>
            <div class="cat-card floating" onclick="filterByCategory('roses')">
                <img src="https://img.freepik.com/free-psd/beautiful-rose-studio_23-2151841231.jpg?semt=ais_hybrid&w=740&q=80" alt="ورد" class="cat-img">
                <span>فازات</span>
            </div>
            <!--  <div class="cat-card floating" onclick="filterByCategory('tulips')">
          <img src="https://png.pngtree.com/png-vector/20231015/ourmid/pngtree-bouquet-of-tulips-png-image_10164187.png" alt="توليب" class="cat-img">
          <span>توليب</span>
      </div>-->
            <div class="cat-card floating" onclick="filterByCategory('bouquets')">
                <img src="https://png.pngtree.com/png-clipart/20250415/original/pngtree-beautiful-bouquet-png-image_20822534.png" alt="باقات" class="cat-img">
                <span>باقات جاهزة</span>
            </div>
        </div>
    </section>

    <main class="container">

        <div id="bouquetBuilderModal" class="modal">
            <div class="modal-content">
                <span class="close-btn" onclick="closeBouquetBuilder()">×</span>
                <div class="modal-header">
                    <h2><i class="fas fa-wand-magic-sparkles"></i> صمم باقتك</h2>
                </div>
                <div class="builder-layout">
                    <div class="visual-section">
                        <div class="sticky-preview-container">
                            <div id="bouquetCanvas" class="bouquet-canvas">
                                <img src="https://i.postimg.cc/C1cjzMZt/ablabla.png" class="wrapping-paper-bg" id="mainWrapperImg" alt="تغليف">
                                <div id="flowersOverlay" class="flowers-overlay"></div>
                                <div id="giftCardOverlay" class="gift-card-container hidden" style="width: 110px; height: 70px; top: 30px; font-size: 0.9rem;">
                                    <span id="giftCardTextDisplay">أحبك</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="controls-section" style="flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px;">
                        <div class="flowers-scroll-container">
                            <h4><i class="fas fa-spa"></i> اضغط لإضافة الورد:</h4>
                            <div id="flowerOptions" class="horizontal-scroll-list"></div>
                        </div>
                        <div class="style-scroll-container">
                            <h4><i class="fas fa-shopping-bag"></i> اختر البوكيه:</h4>
                            <div id="designOptions" class="horizontal-scroll-list designs-list"></div>
                        </div>
                        <div class="message-container" style="background: white; padding: 15px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.03);">
                            <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed #eee;">
                                <h4 style="margin-bottom: 8px; font-size: 0.9rem;"><i class="fas fa-palette"></i> لون الكارت:</h4>
                                <div class="color-options" style="display: flex; gap: 10px;">
                                    <div onclick="document.querySelectorAll('.color-circle').forEach(c=>c.style.border='1px solid #ddd'); this.style.border='2px solid var(--accent-pink)'; document.getElementById('giftCardOverlay').style.background = '#fffdf9'; document.getElementById('giftCardOverlay').style.color = '#4a4a4a';" class="color-circle" style="width: 30px; height: 30px; background: #fffdf9; border: 1px solid #ddd; border-radius: 50%; cursor: pointer;"></div>
                                    <div onclick="document.querySelectorAll('.color-circle').forEach(c=>c.style.border='1px solid #ddd'); this.style.border='2px solid var(--accent-pink)'; document.getElementById('giftCardOverlay').style.background = '#ffccd5'; document.getElementById('giftCardOverlay').style.color = '#5a0000';" class="color-circle" style="width: 30px; height: 30px; background: #ffccd5; border: 1px solid #ddd; border-radius: 50%; cursor: pointer;"></div>
                                    <div onclick="document.querySelectorAll('.color-circle').forEach(c=>c.style.border='1px solid #ddd'); this.style.border='2px solid var(--accent-pink)'; document.getElementById('giftCardOverlay').style.background = '#2c2c2c'; document.getElementById('giftCardOverlay').style.color = '#ffffff';" class="color-circle" style="width: 30px; height: 30px; background: #2c2c2c; border: 1px solid #ddd; border-radius: 50%; cursor: pointer;"></div>
                                    <div onclick="document.querySelectorAll('.color-circle').forEach(c=>c.style.border='1px solid #ddd'); this.style.border='2px solid var(--accent-pink)'; document.getElementById('giftCardOverlay').style.background = '#e0c3ff'; document.getElementById('giftCardOverlay').style.color = '#2d004d';" class="color-circle" style="width: 30px; height: 30px; background: #e0c3ff; border: 1px solid #ddd; border-radius: 50%; cursor: pointer;"></div>
                                </div>
                            </div>
                            <h4 style="margin-bottom: 5px;"><i class="fas fa-pen-nib"></i> رسالة الكارت:</h4>
                            <textarea id="giftMessageInput" placeholder="اكتب رسالتك هنا..." style="width:100%; padding:10px; border-radius:10px; border:1px solid #ddd; resize:none; font-family: inherit;" oninput="updateGiftCard(this.value)"></textarea>
                        </div>
                        <button class="btn-download" onclick="downloadBouquetImage()" style="background: #6c5ce7; color: white; width: 100%; padding: 10px; border-radius: 15px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(108, 92, 231, 0.2);">
                            <i class="fas fa-camera"></i> حفظ صورة الباقة
                        </button>
                      
                        <button class="btn-buy-large" onclick="addCustomBouquetToCart()" style="width: 100%; padding: 18px; font-size: 1.1rem; box-shadow: 0 8px 25px rgba(231, 84, 128, 0.4); margin-bottom: 20px;">
                            إضافة للسلة <i class="fas fa-check" style="margin-right: 8px;"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="products-grid" id="productsContainer">
        </div>

    </main>

    <!-- Features Section -->


    <section id="checkoutSection" class="container hidden" style="margin-top: 40px; margin-bottom: 80px;">
        <div class="product-details-container" style="display: grid; grid-template-columns: 1fr 350px; gap: 30px;">

            <div class="checkout-form-side">
                <h2 style="color: var(--accent-pink); margin-bottom: 25px;">
                    <i class="fas fa-shipping-fast"></i> بيانات الشحن والتوصيل
                </h2>
                <form id="orderForm" onsubmit="sendOrderToWhatsapp(event)">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">الاسم</label>
                        <input type="text" id="custName" required style="width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">رقم الهاتف</label>
                        <input type="tel" id="custPhone" required placeholder="01xxxxxxxxx" style="width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px;">العنوان بالتفصيل</label>
                        <textarea id="custAddress" required style="width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd;"></textarea>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px;">طريقة الدفع</label>
                            <select id="paymentMethod" style="width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd;">
                                <option value="Cash">دفع عند الاستلام</option>
                            </select>
                        </div>

                    </div>
                    <button type="submit" class="btn-buy-large" style="background: #25d366; border: none;">
                        تأكيد الطلب عبر واتساب <i class="fab fa-whatsapp"></i>
                    </button>
                </form>
            </div>

            <div class="checkout-summary-side" style="background: white; padding: 25px; border-radius: 20px; box-shadow: var(--shadow-soft); align-self: start;">
                <h3 style="border-bottom: 2px solid var(--bg-body); padding-bottom: 10px; margin-bottom: 15px;">ملخص الحساب</h3>
                <div id="checkoutItemsList" style="max-height: 300px; overflow-y: auto; margin-bottom: 15px;">
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.2rem; color: var(--accent-pink); border-top: 2px dashed #eee; pt: 15px; margin-top: 15px;">
                    <span>الإجمالي:</span>
                    <span id="finalTotalAmount">0 ر.س</span>
                </div>
            </div>
        </div>
    </section>

    <section class="features-section">
        <div class="container">
            <div class="features-wrapper">
                <div class="features-image">
                    <img src="https://mspmag.com/downloads/61859/download/image002.jpg?cb=de465bc50a9e5635ec2a607d7d4f453c&w=1280" alt="تجربة فريدة">
                </div>
                <div class="features-list-content">
                    <h2 style="color: var(--accent-pink); margin-bottom: 40px;">لماذا تختارنا؟</h2>

                    <div class="feature-item">
                        <div class="icon-box">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="text">
                            <h3>ورود طازجة يومياً</h3>
                            <p>نحضر ورودنا مباشرة من المزارع المختارة، نضمن لك الجودة والطزاجة في كل باقة</p>
                        </div>
                    </div>

                    <div class="feature-item">
                        <div class="icon-box">
                            <i class="fas fa-truck"></i>
                        </div>
                        <div class="text">
                            <h3>توصيل سريع ومجاني</h3>
                            <p>نوصلك في أي وقت</p>
                        </div>
                    </div>

                    <div class="feature-item">
                        <div class="icon-box">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="text">
                            <h3>تغليف فاخر</h3>
                            <p>كل باقة تحصل على تغليف خاص وأنيق، مناسب لكل المناسبات</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="site-footer">
        <div class="container">
            <div class="footer-grid">

                <div class="footer-col">

                    <a href="#" onclick="goHome()" style="display: block; margin-bottom: 20px;">
                        <img src="https://i.postimg.cc/fRhb2V5f/file.jpg" alt="Rose Garden Logo"
                             style="height: 80px; width: auto; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    </a>

                    <p style="color: rgba(255,255,255,0.8); margin: 0 0 20px 0; line-height: 1.8;">
                        موقع <strong>Rose Garden</strong> - وجهتك الأولى للورود الفاخرة والعطور الطبيعية، نقدم تجربة فريدة في عالم الزهور.
                    </p>

                    <div class="delivery-alert">
                        <i class="fas fa-truck"></i>
                        <p>
                            نطاق التوصيل:<br>
                            <strong>جدة</strong>
                        </p>
                    </div>

                    <div style="margin-top: 20px;">
                        <div style="display: flex; align-items: flex-start; gap: 10px; color: rgba(255,255,255,0.9); margin-bottom: 10px;">
                            <i class="fas fa-map-pin" style="color: var(--accent-pink); font-size: 1.2rem; margin-top: 5px;"></i>
                            <p style="margin: 0; line-height: 1.6; font-size: 0.95rem;">
                                <strong>فرعنا الرئيسي:</strong><br>
                                جده، حي الصفا، شارع الاربعين<br>
                                مقابل مستشفى الجدعاني، بجوار حاشي باشا
                            </p>
                        </div>

                        <a href="https://maps.app.goo.gl/EGXJR7cwb5YAr8tc9" target="_blank" class="btn-location">
                            <i class="fas fa-location-arrow"></i> اضغط لفتح اللوكيشن
                        </a>
                    </div>
                </div>

                <div class="footer-col">
                    <h4 style="color: white;">روابط سريعة</h4>
                    <ul class="footer-links" style="list-style: none;">
                        <li><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">الرئيسية</a></li>
                        <li><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">المجموعات</a></li>
                        <li><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">باقات المناسبات</a></li>
                        <li><a href="#" style="color: rgba(255,255,255,0.8); text-decoration: none;">اتصل بنا</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4 style="color: white;">تواصل معنا</h4>
                    <div class="social-links">
                        <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>

                        <a href="https://www.tiktok.com/@roose.garden9" class="social-icon" target="_blank">
                            <i class="fab fa-tiktok"></i>
                        </a>

                        <a href="https://wa.me/966546458993" class="social-icon" target="_blank">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>جميع الحقوق محفوظة &copy; 2026 <strong>Rose Garden</strong></p>
            </div>
        </div>
    </footer>

    <!-- Cart Sidebar -->
    <div id="cartSidebar" class="cart-sidebar">
        <div class="cart-header">
            <h3><i class="fas fa-shopping-basket"></i> سلة المشتريات</h3>
            <span class="close-btn" onclick="closeCart()">&times;</span>
        </div>
        <div class="cart-items" id="cartItemsContainer">
            <!-- سيتم تحميل عناصر السلة هنا -->
        </div>
        <div class="cart-footer">
            <div class="total" style="display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 1.2rem;">
                <span>الإجمالي:</span>
                <span id="cartTotal">0 ر.س</span>
            </div>
            <button class="btn-checkout" onclick="openCheckout()">
                <i class="fas fa-lock"></i> إتمام الشراء
            </button>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div id="modalContent">
                <!-- سيتم تحميل تفاصيل المنتج هنا -->
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast">
        <i class="fas fa-check-circle" style="color: var(--accent-pink);"></i>
        <span id="toastMessage">تمت الإضافة إلى السلة</span>
    </div>

    <!-- Overlay -->
    <div class="overlay" onclick="closeCart()"></div>

    <!-- Mobile Bottom Navigation -->
    <div class="mobile-bottom-nav">
        <a href="#" class="nav-item" onclick="goHome()">
            <i class="fas fa-home"></i>
            <span>الرئيسية</span>
        </a>

        <a href="#" class="nav-item" onclick="openCart()" style="position: relative;">
            <i class="fas fa-shopping-basket"></i>
            <span>السلة</span>
            <span class="mobile-badge" style="display: none;">0</span>
        </a>

        <a href="javascript:void(0)" class="nav-item" onclick="openWishlist()">
            <i class="fas fa-heart"></i>
            <span>المفضلة</span>
        </a>
    </div>

    <script type="module">

        // استبدل الرابط داخل src برابط اللوجو الخاص بك
        const riyalIcon = `<img src="https://i.postimg.cc/HWhBJPs9/20250313031815-Saudi-Riyal-Symbol-svg.png" class="currency-icon" alt="SAR">`;

        // ==================== استيراد مكتبات الفاير بيس ====================
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // ==================== إعدادات الفاير بيس ====================
        const firebaseConfig = {
            apiKey: "AIzaSyBXX5DiibUj0ATSqEZiqLwvniuTLG3ZHW4",
            authDomain: "rosegarden-61735.firebaseapp.com",
            projectId: "rosegarden-61735",
            storageBucket: "rosegarden-61735.firebasestorage.app",
            messagingSenderId: "944666103960",
            appId: "1:944666103960:web:c196ca2c5f0ac4958080ed",
            measurementId: "G-NSC5GBWLJE"
        };

        // تهيئة الفاير بيس
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ==================== 1. بيانات المنتجات ====================
        let products = [];

        // دالة جلب المنتجات من الفاير بيس
        async function fetchProductsFromDB() {
            try {
                const querySnapshot = await getDocs(collection(db, "products"));
                products = [];
                querySnapshot.forEach((doc) => {
                    products.push({ id: doc.id, ...doc.data() });
                });
                filterByCategory('all');
            } catch (error) {
                console.error("Error fetching products:", error);
                showToast("حدث خطأ في تحميل المنتجات");
            }
        }

        // ==================== بيانات مصمم الباقات ====================
        const singleFlowers = [
            // --- الورود القديمة ---
            { id: 'f1', name: 'بيبي روز', img: 'https://i.postimg.cc/Gp4QmMcj/Chat-GPT-Image-Jan-28-2026-05-44-49-PM.png' },
            { id: 'f2', name: 'بيبي روز', img: 'https://i.postimg.cc/W13m59JD/Chat-GPT-Image-Jan-28-2026-05-53-04-PM.png' },
            { id: 'f3', name: 'بيبي روز', img: 'https://i.postimg.cc/tJpWWDjb/Chat-GPT-Image-Jan-28-2026-05-50-23-PM.png' },
            // تم حذف f4 (صورة متكررة)
            { id: 'f5', name: 'بيبي روز', img: 'https://i.postimg.cc/g2XXw1ZH/Chat-GPT-Image-Jan-28-2026-05-58-19-PM.png' },

            // --- الورود الجديدة ---
            { id: 'f6', name: 'بيبي روز', img: 'https://i.postimg.cc/qR0z5RZQ/Chat-GPT-Image-Jan-28-2026-05-34-08-PM.png' },
            { id: 'f7', name: 'بيبي روز', img: 'https://i.postimg.cc/tJ479cbZ/Chat-GPT-Image-Jan-28-2026-05-38-00-PM.png' },
            { id: 'f8', name: 'ديانتوس', img: 'https://i.postimg.cc/6QXq1qym/Chat-GPT-Image-Jan-28-2026-07-08-05-PM.png' },
            { id: 'f9', name: 'بيبي روز', img: 'https://i.postimg.cc/N0qDJ68K/Chat-GPT-Image-Jan-28-2026-07-17-35-PM.png' },
            // تم حذف f10 (بدون صورة)
            // تم حذف f11 (بدون صورة)

            { id: 'f12', name: 'وردة جميلة', img: 'https://i.postimg.cc/xCZsnwD1/Chat-GPT-Image-Jan-28-2026-06-51-56-PM.png' },
            { id: 'f13', name: 'وردة جميلة', img: 'https://i.postimg.cc/Fs0QCZ37/Chat-GPT-Image-Jan-28-2026-05-53-58-PM.png' },
            { id: 'f15', name: 'وردة جميلة', img: 'https://i.postimg.cc/d1gz4k0g/Chat-GPT-Image-Jan-28-2026-05-34-58-PM.png' },

            { id: 'f16', name: 'وردة جميلة', img: 'https://i.postimg.cc/6qzc3qPK/Chat-GPT-Image-Jan-28-2026-07-59-01-PM.png' },
            { id: 'f17', name: 'وردة جميلة', img: 'https://i.postimg.cc/JnL55jVr/Chat-GPT-Image-Jan-28-2026-07-59-53-PM.png' },
            { id: 'f18', name: 'وردة جميلة', img: 'https://i.postimg.cc/tJRdLy4S/Chat-GPT-Image-Jan-28-2026-08-01-23-PM.png' },
            // تم حذف f19 (صورة متكررة لـ f9)
            { id: 'f20', name: 'وردة جميلة', img: 'https://i.postimg.cc/W4MMztDr/Chat-GPT-Image-Jan-28-2026-07-38-53-PM.png' },

            { id: 'f21', name: 'وردة جميلة', img: 'https://i.postimg.cc/XJ49C3dX/Chat-GPT-Image-Jan-28-2026-07-43-00-PM.png' },
            { id: 'f22', name: 'وردة جميلة', img: 'https://i.postimg.cc/gj0RgDgN/Chat-GPT-Image-Jan-28-2026-07-57-53-PM.png' },
            { id: 'f23', name: 'وردة جميلة', img: 'https://i.postimg.cc/0ySSXrC8/Chat-GPT-Image-Jan-28-2026-07-56-01-PM.png' },
        ];

        const bouquetDesigns = [
            { id: 'd4', name: 'قلب الحب', layout: 'heart', img: 'https://bloomthis.co/cdn/shop/files/bloomthis-bouquet-bridie-red-rose-bouquet-1080x1080-01.jpg?v=1743059546&width=600' },
            { id: 'd1', name: 'القبة الكلاسيكية', layout: 'dome', img: 'https://cdn01.pinkoi.com/product/qjTEkbfP/0/2/640x530.jpg' },
            { id: 'd2', name: 'الشلال الملكي', layout: 'cascade', img: 'https://www.sonningflowers.com/wp-content/uploads/2016/06/Pretty-in-Pink-Option-1-1024_compress51.jpg' },
            { id: 'd3', name: 'الفخامة السوداء', layout: 'dense-spiral', img: 'https://www.fnp.ae/images/pr/l/v20251024221903/purple-flowers-bouquet_2.jpg' }
        ];

        // ==================== 2. المتغيرات العامة ====================
        let cart = JSON.parse(localStorage.getItem('flowerCart')) || [];
        let wishlist = JSON.parse(localStorage.getItem('flowerWishlist')) || [];
        let myCustomBouquet = [];
        let currentLayout = 'heart';

        // ==================== 3. الوظائف الرئيسية ====================

        window.toggleWishlist = function (id, btnElement) {
            if (event) event.stopPropagation();
            const index = wishlist.indexOf(id);

            if (index === -1) {
                wishlist.push(id);
                if (btnElement) {
                    btnElement.classList.add('active');
                    btnElement.innerHTML = '<i class="fas fa-heart"></i>';
                }
                showToast('تمت الإضافة للمفضلة');
            } else {
                wishlist.splice(index, 1);
                if (btnElement) {
                    btnElement.classList.remove('active');
                    btnElement.innerHTML = '<i class="far fa-heart"></i>';
                }
                showToast('تم الحذف من المفضلة');
            }
            localStorage.setItem('flowerWishlist', JSON.stringify(wishlist));

            // تحديث شكل القلوب في الصفحة الرئيسية تلقائياً
            filterByCategory('all');
        };

        window.filterByCategory = function (cat) {
            const container = document.getElementById('productsContainer');
            if (!container) return;

            const cards = document.querySelectorAll('.cat-card');
            cards.forEach(c => c.classList.remove('active'));
            if (event && event.currentTarget) event.currentTarget.classList.add('active');

            const filtered = cat === 'all' ? products : products.filter(p => p.category === cat);

            // الكارت الأسطوري
            let htmlContent = `
                <div class="product-card custom-bouquet-card legendary-card" onclick="openBouquetBuilder()" style="cursor: pointer;">
                    <div class="legendary-badge">
                        <i class="fas fa-star"></i> تجربة حصرية
                    </div>
                    <div class="glow-effect"></div>
                    <div class="img-container">
                        <img src="https://i.postimg.cc/ZngmNk37/unnamed.png" alt="صمم باقتك">
                    </div>
                    <div class="details">
                        <h3><i class="fas fa-crown" style="color: #ffd700; margin-left: 5px;"></i> اصنع باقة أحلامك</h3>
                        <p>لا تختار المعتاد.. صمم باقة فريدة تعبر عنك تماماً.</p>
                        <button class="btn-legendary-action" onclick="event.stopPropagation(); openBouquetBuilder()" style="position: relative; z-index: 10;">
                            <span class="btn-text">ابدأ التصميم الآن</span>
                            <span class="btn-icon"><i class="fas fa-wand-magic-sparkles"></i></span>
                        </button>
                    </div>
                </div>
            `;

            if (filtered.length === 0 && cat !== 'all') {
                htmlContent += `<div style="grid-column: 1/-1; text-align: center; padding: 20px;">لا توجد منتجات في هذا القسم حالياً</div>`;
            }

            // داخل دالة window.filterByCategory
            htmlContent += filtered.map((p, index) => { // لاحظ إضافة index هنا
                const isLiked = wishlist.includes(p.id);
                const heartClass = isLiked ? 'active' : '';
                const heartIcon = isLiked ? 'fas fa-heart' : 'far fa-heart';

                // حساب التأخير الزمني بناءً على ترتيب الكارت
                // كل كارت يتأخر 0.1 ثانية عن اللي قبله
                const delay = index * 0.1;

                return `
<div class="product-card smooth-entry" style="animation-delay: ${delay}s;">
    <div class="product-badge">جديد</div>
    
    <div class="img-container" onclick="openProductPage('${p.id}')" style="cursor: pointer;">
        <img src="${p.image}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/300'">
    </div>

    <div class="details">
        <h3>${p.name}</h3>
<span class="price">${p.price} ${riyalIcon}</span>
                        <div class="buttons-wrapper">
                            <button class="btn-quick-add" onclick="event.stopPropagation(); addToCart('${p.id}')">
                                أضف <i class="fas fa-cart-plus"></i>
                            </button>
                            <button class="btn-love ${heartClass}" onclick="event.stopPropagation(); toggleWishlist('${p.id}', this)">
                                <i class="${heartIcon}"></i>
                            </button>
                        </div>
                    </div>
                </div>`;
            }).join('');

            container.innerHTML = htmlContent;
        }

        window.openProductPage = function (id) {
            const p = products.find(prod => prod.id == id);
            if (!p) return;

            const page = document.getElementById('fullProductPage');
            const content = document.getElementById('fullPageContent');
            const title = document.getElementById('pageProductTitle');

            const isLiked = wishlist.includes(p.id);
            const heartClass = isLiked ? 'active' : '';
            const heartIcon = isLiked ? 'fas fa-heart' : 'far fa-heart';

            // (جديد) تحديد الوصف: إذا كان موجوداً في قاعدة البيانات نستخدمه، وإلا نستخدم النص الافتراضي
            const productDescription = p.description ? p.description : "استمتع بجمال الطبيعة مع هذه الباقة المختارة بعناية من أجود أنواع الزهور.";

            title.innerText = p.name;

            content.innerHTML = `
        <div class="main-img">
            <img src="${p.image}" onerror="this.src='https://via.placeholder.com/500'">
        </div>
        <div class="product-info">
            <h2 style="color: var(--text-main);">${p.name}</h2>
<div class="price-box">
    ${p.price} ${riyalIcon}
</div>

            <p class="description">
                ${productDescription}
            </p>

<ul class="features-list">
                <li><i class="fas fa-truck"></i> توصيل سريع خلال ساعتين</li>
                <li><i class="fas fa-leaf"></i> زهور طبيعية 100%</li>
                <li><i class="fas fa-gift"></i> تغليف مجاني فاخر</li>
            </ul>

            <div class="product-actions-bar">
                <button class="btn-buy-large" onclick="addToCart('${p.id}')">
                    إضافة للسلة <i class="fas fa-cart-plus" style="margin-right:8px;"></i>
                </button>
                
                <button class="btn-love-large ${heartClass}" onclick="toggleWishlist('${p.id}', this)">
                    <i class="${heartIcon}"></i>
                </button>
            </div>

        </div>`; 

            page.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        window.closeProductPage = function () {
            document.getElementById('fullProductPage').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // ==================== 4. منطق السلة ====================
        function triggerPetals() {
            const duration = 1000;
            const end = Date.now() + duration;
            (function frame() {
                confetti({ particleCount: 2, angle: 60, spread: 55, origin: { x: 0 }, colors: ['#ff0000', '#ff69b4', '#e75480'], shapes: ['circle'], scalar: 1.2 });
                confetti({ particleCount: 2, angle: 120, spread: 55, origin: { x: 1 }, colors: ['#ff0000', '#ff69b4', '#e75480'], shapes: ['circle'], scalar: 1.2 });
                if (Date.now() < end) { requestAnimationFrame(frame); }
            }());
        }

        window.addToCart = function (productId) {
            const product = products.find(p => p.id == productId);
            if (!product) return;
            const existingItem = cart.find(item => item.id == productId);
            if (existingItem) { existingItem.quantity += 1; }
            else { cart.push({ ...product, quantity: 1 }); }

            updateCart();
            showToast('تمت الإضافة للسلة');
            triggerPetals();
        }

        window.filterByCategory = function (cat) {
            const container = document.getElementById('productsContainer');
            if (!container) return;

            // تنشيط زر الفلتر المختار
            const cards = document.querySelectorAll('.cat-card');
            cards.forEach(c => c.classList.remove('active'));
            if (event && event.currentTarget) event.currentTarget.classList.add('active');

            // تصفية المنتجات بناءً على الفئة
            const filtered = cat === 'all' ? products : products.filter(p => p.category === cat);

            // تجهيز كود HTML (نبدأ بكارت التصميم الخاص)
            let htmlContent = `
        <div class="product-card custom-bouquet-card legendary-card" onclick="openBouquetBuilder()" style="cursor: pointer;">
            <div class="legendary-badge"><i class="fas fa-star"></i> تجربة حصرية</div>
            <div class="glow-effect"></div>
            <div class="img-container">
                <img src="https://i.postimg.cc/ZngmNk37/unnamed.png" alt="صمم باقتك">
            </div>
            <div class="details">
                <h3><i class="fas fa-crown" style="color: #ffd700;"></i> اصنع باقة أحلامك</h3>
                <p>صمم باقة فريدة تعبر عنك.</p>
                <button class="btn-legendary-action" onclick="event.stopPropagation(); openBouquetBuilder()">
                    <span class="btn-text">ابدأ التصميم</span>
                    <span class="btn-icon"><i class="fas fa-wand-magic-sparkles"></i></span>
                </button>
            </div>
        </div>
    `;

            // إذا لم توجد منتجات من الفاير بيس
            if (filtered.length === 0 && cat !== 'all') {
                htmlContent += `<div style="grid-column: 1/-1; text-align: center; padding: 20px;">لا توجد منتجات في هذا القسم حالياً</div>`;
            }

            // إضافة منتجات الفاير بيس
            htmlContent += filtered.map((p, index) => {
                const isLiked = wishlist.includes(p.id);
                const heartClass = isLiked ? 'active' : '';
                const heartIcon = isLiked ? 'fas fa-heart' : 'far fa-heart';
                const delay = index * 0.1; // تأخير بسيط للأنيميشن

                return `
        <div class="product-card smooth-entry" style="animation-delay: ${delay}s;">
            <div class="product-badge">جديد</div>
            
            <div class="img-container" onclick="openProductPage('${p.id}')" style="cursor: pointer;">
                <img src="${p.image}" alt="${p.name}" loading="lazy" onerror="this.src='https://via.placeholder.com/300'">
                <div class="product-overlay">
                    <button class="quick-view-btn" onclick="event.stopPropagation(); openProductPage('${p.id}')">
                        <i class="fas fa-eye"></i> معاينة
                    </button>
                </div>
            </div>

            <div class="details">
                <h3>${p.name}</h3>
                <span class="price">${p.price} ${riyalIcon}</span>
                
                <div class="buttons-wrapper">
                    <button class="btn-quick-add" onclick="event.stopPropagation(); addToCart('${p.id}')">
                        أضف <i class="fas fa-cart-plus"></i>
                    </button>
                    
                    <button class="btn-love ${heartClass}" onclick="event.stopPropagation(); toggleWishlist('${p.id}', this)">
                        <i class="${heartIcon}"></i>
                    </button>
                </div>
            </div>
        </div>`;
            }).join('');

            // وضع المحتوى النهائي في الصفحة
            container.innerHTML = htmlContent;
        }

        window.openBouquetBuilder = function () {
            const modal = document.getElementById('bouquetBuilderModal');
            modal.style.display = 'flex';
            modal.classList.add('show-modal');
            document.body.style.overflow = 'hidden';

            // تهيئة الخيارات
            renderFlowerOptions();
            renderDesignOptions();

            // === هذا هو الجزء الجديد لإصلاح ظهور الكارت ===
            const card = document.getElementById('giftCardOverlay');
            if (card) {
                card.classList.remove('hidden'); // إظهار الكارت بإزالة كلاس الإخفاء
                makeDraggable(card); // تفعيل خاصية السحب للكارت

                // إعادة ترتيب الطبقات لضمان أن الكارت فوق الورد
                card.style.zIndex = "20";
            }
        }

        window.closeBouquetBuilder = function () {
            const modal = document.getElementById('bouquetBuilderModal');
            modal.style.display = 'none';
            modal.classList.remove('show-modal');
            document.body.style.overflow = 'auto';
        }


        function renderDesignOptions() {
            document.getElementById('designOptions').innerHTML = bouquetDesigns.map((d) => `
                <div class="design-item ${d.layout === currentLayout ? 'active' : ''}" onclick="changeBouquetDesign('${d.id}', this)">
                    <img src="${d.img}">
                </div>`).join('');
        }

        window.changeBouquetDesign = function (designId, element) {
            const design = bouquetDesigns.find(d => d.id === designId);
            if (!design) return;
            currentLayout = design.layout;
            rearrangeFlowers();
            document.querySelectorAll('.design-item').forEach(el => el.classList.remove('active'));
            element.classList.add('active');
        }

        function getPositionForLayout(layout, index, totalFlowers) {
            let top, left, rotate, scale;
            const randomOffset = (amount = 5) => (Math.random() * amount) - (amount / 2);
            switch (layout) {
                case 'dome':
                    const angleDome = index * 137.5; const rDome = 4 * Math.sqrt(index);
                    left = 50 + (rDome * Math.cos(angleDome * Math.PI / 180));
                    top = 40 + (rDome * Math.sin(angleDome * Math.PI / 180)) * 0.8;
                    rotate = index * 10; scale = Math.max(0.7, 1 - (index * 0.02));
                    break;
                case 'cascade':
                    top = 20 + (index * 6);
                    left = 50 + ((index % 2 === 0 ? 1 : -1) * (Math.random() * 15));
                    rotate = (left - 50) * 2; scale = 1;
                    break;
                case 'grouping':
                    const isRight = index % 2 === 0;
                    left = isRight ? 65 + randomOffset(15) : 35 + randomOffset(15);
                    top = 30 + (index * 3) + randomOffset(10);
                    rotate = isRight ? 15 : -15; scale = 0.9;
                    break;
                case 'dense-spiral':
                    const rSpiral = 3.5 * Math.sqrt(index); const thetaSpiral = index * 137.508;
                    left = 50 + (rSpiral * Math.cos(thetaSpiral * Math.PI / 180));
                    top = 45 + (rSpiral * Math.sin(thetaSpiral * Math.PI / 180));
                    rotate = index * 10; scale = 1 - (index * 0.005);
                    break;
                case 'heart':
                    let t = (index / (totalFlowers + 1)) * (2 * Math.PI);
                    const xHeart = 16 * Math.pow(Math.sin(t), 3);
                    const yHeart = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
                    left = 50 + (xHeart * 1.5); top = 35 - (yHeart * 1.5);
                    rotate = 0; scale = 0.85;
                    break;
                default: left = 50; top = 50; rotate = 0; scale = 1;
            }
            return { top, left, rotate, scale };
        }

        window.addFlowerToBouquet = function (id) {
            const flower = singleFlowers.find(f => f.id === id);
            if (!flower) return;
            const existing = myCustomBouquet.find(item => item.id === id);
            if (existing) existing.qty++; else myCustomBouquet.push({ ...flower, qty: 1 });

            const overlay = document.getElementById('flowersOverlay');
            const img = document.createElement('img');
            img.src = flower.img;
            img.className = 'flower-on-canvas';

            // 👇👇👇 هنا التعديل: غير الرقم ده (كان 80 وخليناه 130) 👇👇👇
            img.style.width = '130px';
            // 👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆👆

            img.style.transition = 'transform 0.3s ease'; img.style.zIndex = '10';
            img.style.cursor = 'grab'; img.style.touchAction = 'none';

            if (['dome', 'heart', 'dense-spiral'].includes(currentLayout)) {
                img.style.transformOrigin = 'center center';
            } else {
                img.style.transformOrigin = 'bottom center';
            }

            overlay.appendChild(img);
            makeDraggable(img);
            rearrangeFlowers();
            updateBouquetSummary();
        }

        function rearrangeFlowers() {
            const flowers = document.querySelectorAll('.flower-on-canvas');
            flowers.forEach((img, index) => {
                if (img.classList.contains('moved-manually')) return;
                const pos = getPositionForLayout(currentLayout, index, flowers.length);
                img.style.top = pos.top + '%'; img.style.left = pos.left + '%';
                img.style.transform = `translateX(-50%) rotate(${pos.rotate}deg) scale(${pos.scale})`;

                if (['dome', 'heart', 'dense-spiral'].includes(currentLayout)) {
                    img.style.transformOrigin = 'center center';
                } else {
                    img.style.transformOrigin = 'bottom center';
                }
            });
        }

        function updateBouquetSummary() {
            const list = document.getElementById('selectedFlowersList');
            const totalEl = document.getElementById('customBouquetTotal');
            // هذا السطر لإخفاء أيقونة العملة الكبيرة بجانب الإجمالي
            const currencyIconEl = document.querySelector('.bouquet-summary .currency-icon');

            if (!list) return;

            // إخفاء أيقونة العملة بجانب الإجمالي
            if (currencyIconEl) currencyIconEl.style.display = 'none';

            if (myCustomBouquet.length === 0) {
                list.innerHTML = '<p class="empty-msg">الباقة فارغة..</p>';
                totalEl.textContent = '0';
                return;
            }

            let total = 0; // ممكن تخليها 0 لو مش عايز سعر أساسي

            list.innerHTML = myCustomBouquet.map(item => {
                total += (item.price * item.qty);

                // هنا التعديل: شلنا الجزء الخاص بالسعر والعملة
                return `<div style="display:flex; justify-content:space-between; align-items:center;">
                    <span>${item.name} x${item.qty}</span>
                    </div>`;
            }).join('');

            totalEl.innerHTML = total;

            // إخفاء كلمة "الإجمالي" والرقم بالكامل لو تحب (اختياري)
            // document.querySelector('.total-price').style.display = 'none';
        }

        window.addCustomBouquetToCart = function () {
            if (myCustomBouquet.length === 0) return showToast('الباقة فارغة!');
            const total = document.getElementById('customBouquetTotal').textContent;
            const currentDesignImg = bouquetDesigns.find(d => d.layout === currentLayout).img;

            cart.push({ id: 'custom-' + Date.now(), name: 'باقة من تصميمك', price: parseInt(total), quantity: 1, image: currentDesignImg });

            updateCart();
            closeBouquetBuilder();
            resetBouquet();
            showToast('تم حفظ التصميم وإضافته للسلة!');
            triggerPetals();
        }

        function makeDraggable(element) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            element.addEventListener('mousedown', dragStart, false);
            element.addEventListener('touchstart', dragStart, { passive: false });

            function dragStart(e) {
                if (e.type === 'touchstart') { pos3 = e.touches[0].clientX; pos4 = e.touches[0].clientY; }
                else { e.preventDefault(); pos3 = e.clientX; pos4 = e.clientY; }
                element.style.zIndex = "1000";
                document.addEventListener('mouseup', closeDrag);
                document.addEventListener('mousemove', elementDrag);
                document.addEventListener('touchend', closeDrag);
                document.addEventListener('touchmove', elementDrag, { passive: false });
            }

            function elementDrag(e) {
                if (e.cancelable) e.preventDefault();
                let clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
                let clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
                pos1 = pos3 - clientX; pos2 = pos4 - clientY;
                pos3 = clientX; pos4 = clientY;
                element.style.top = (element.offsetTop - pos2) + "px";
                element.style.left = (element.offsetLeft - pos1) + "px";
                element.classList.add('moved-manually');
            }

            function closeDrag() {
                document.removeEventListener('mouseup', closeDrag);
                document.removeEventListener('mousemove', elementDrag);
                document.removeEventListener('touchend', closeDrag);
                document.removeEventListener('touchmove', elementDrag);
                element.style.zIndex = "10";
            }
        }

        // ==================== 6. أدوات وتشغيل ====================

        // دالة التوست المعدلة (4 ثواني)
        function showToast(msg) {
            const t = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = msg;

            // إظهار الرسالة
            t.classList.add('show');

            // إخفاء الرسالة بعد 4000 ميلي ثانية (4 ثواني)
            setTimeout(() => {
                t.classList.remove('show');
            }, 4000);
        }

        window.openCart = function () {
            document.getElementById('cartSidebar').classList.add('active');
            document.querySelector('.overlay').classList.add('active');
            updateCart();

            // إخفاء زر الواتساب عند فتح السلة
            const whatsappBtn = document.querySelector('.whatsapp-float');
            if (whatsappBtn) whatsappBtn.style.display = 'none';
        }

        window.closeCart = function () {
            document.getElementById('cartSidebar').classList.remove('active');
            document.querySelector('.overlay').classList.remove('active');

            // إعادة إظهار زر الواتساب عند إغلاق السلة
            const whatsappBtn = document.querySelector('.whatsapp-float');
            if (whatsappBtn) whatsappBtn.style.display = 'flex';
        }

        window.openCheckout = function () {
            if (cart.length === 0) return showToast('السلة فارغة!');

            // إظهار قسم الدفع
            const checkoutSection = document.getElementById('checkoutSection');
            checkoutSection.classList.remove('hidden');

            // إخفاء الأقسام الأخرى
            document.querySelector('.hero').style.display = 'none';
            document.querySelector('.categories-section').style.display = 'none';
            document.querySelector('.products-grid').style.display = 'none';

            closeCart(); // إغلاق السلة الجانبية (وهذا سيعيد زر الواتساب للظهور تلقائياً)

            // تعبئة ملخص الطلب
            const container = document.getElementById('checkoutItemsList');
            let total = 0;
            container.innerHTML = cart.map(item => {
                total += item.price * item.quantity;
                return `<div>${item.name} x${item.quantity} = ${item.price * item.quantity} ر.س</div>`;
            }).join('');
            document.getElementById('finalTotalAmount').textContent = total + ' ر.س';

            // التعديل هنا: النزول لأسفل (Scroll Down) بملء الشاشة عند قسم البيانات
            setTimeout(() => {
                checkoutSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        window.goHome = function () {
            document.getElementById('checkoutSection').classList.add('hidden');
            document.querySelector('.hero').style.display = 'block';
            document.querySelector('.categories-section').style.display = 'block';
            document.querySelector('.products-grid').style.display = 'grid';
            window.scrollTo(0, 0);
        }

        function resetBouquet() {
            myCustomBouquet = [];
            document.getElementById('flowersOverlay').innerHTML = '';
            updateBouquetSummary();
        }

        window.downloadBouquetImage = function () {
            const canvasElement = document.getElementById('bouquetCanvas');
            const btn = document.querySelector('.btn-download');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري الحفظ...';

            html2canvas(canvasElement, {
                useCORS: true,
                scale: 2,
                backgroundColor: null
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'my-bloom-bouquet.png';
                link.href = canvas.toDataURL("image/png");
                link.click();
                btn.innerHTML = originalText;
                showToast('تم حفظ صورة الباقة!');
            });
        }

        window.toggleTheme = function () {
            const body = document.body;
            const btn = document.querySelector('.theme-toggle-btn i');
            body.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                btn.classList.remove('fa-moon');
                btn.classList.add('fa-sun');
                showToast('تم تفعيل الوضع المسائي 🌙');
            } else {
                btn.classList.remove('fa-sun');
                btn.classList.add('fa-moon');
                showToast('صباح الخير ☀️');
            }
        }

        // التشغيل
        document.addEventListener('DOMContentLoaded', () => {
            // =========================================================================
            // إصلاح المشكلة: البحث عن المودال ونقله خارج منطقة الخطر (productsContainer)
            // هذا يضمن أن المودال لن يتم حذفه عند تحميل المنتجات
            // =========================================================================
            const modal = document.getElementById('bouquetBuilderModal');
            // إذا كان المودال موجوداً ووالده هو ProductsContainer، انقله للـ Body
            if (modal && modal.parentElement && modal.parentElement.id === 'productsContainer') {
                document.body.appendChild(modal);
                console.log("تم نقل مودال صانع الباقات لمكان آمن تلقائياً.");
            }

            updateCart();
            fetchProductsFromDB();
        });

        // تفعيل استجابة اللمس في الآيفون
        document.addEventListener("touchstart", function () { }, true);

        // ==================== إصلاح دالة تحديث نص الكارت ====================
        window.updateGiftCard = function (text) {
            const displayElement = document.getElementById('giftCardTextDisplay');
            if (displayElement) {
                // تحديث النص، وإذا كان فارغاً نضع نصاً افتراضياً
                displayElement.innerText = text.trim() === "" ? "أحبك يا أمي" : text;
            }
        }

        // ==================== دالة إرسال الطلب للواتساب ====================
        window.sendOrderToWhatsapp = function (e) {
            e.preventDefault(); 
            // 1. جلب البيانات من الخانات
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            const address = document.getElementById('custAddress').value;
            const payment = document.getElementById('paymentMethod').value;

            // 2. التحقق من أن السلة ليست فارغة
            // (ملاحظة: تأكد أن متغير cart معرف لديك في السكريبت الرئيسي)
            if (!cart || cart.length === 0) {
                alert('السلة فارغة! 🛒');
                return;
            }

            // 3. تجهيز تفاصيل المنتجات
            let productsText = "";
            let total = 0;

            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                productsText += `${index + 1}. ${item.name} (عدد ${item.quantity}) - ${itemTotal} ر.س\n`;
            });

            // 4. تنسيق نص الرسالة
            let message = `*طلب جديد من الموقع 🌸*\n\n`;
            message += `👤 *الاسم:* ${name}\n`;
            message += `📱 *الجوال:* ${phone}\n`;
            message += `📍 *العنوان:* ${address}\n`;
            message += `💳 *الدفع:* ${payment}\n`;
            message += `------------------------\n`;
            message += `🛒 *الطلبات:*\n${productsText}`;
            message += `------------------------\n`;
            message += `💰 *الإجمالي:* ${total} ر.س\n\n`;
            message += `يرجى تأكيد الطلب.`;

            // 5. رقم الواتساب (ضع رقمك هنا)
            const myNumber = "966546458993";

            // 6. فتح الرابط
            const url = `https://wa.me/${myNumber}?text=${encodeURIComponent(message)}`;
            window.open(url, '_blank');
        }

        // دالة لفتح نافذة الأمنيات
        window.openWishlist = function () {
            const modal = document.getElementById('wishlistModal');
            const container = document.getElementById('wishlistItemsContainer');

            // تصفية المنتجات الأصلية لإظهار ما هو موجود في قائمة المفضلة فقط
            const favoriteProducts = products.filter(p => wishlist.includes(p.id));

            if (favoriteProducts.length === 0) {
                container.innerHTML = `<div style="text-align:center; padding:20px;">قائمة الأمنيات فارغة حالياً 💔</div>`;
            } else {
                container.innerHTML = favoriteProducts.map(p => `
            <div style="display:flex; align-items:center; gap:15px; margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:10px;">
                <img src="${p.image}" style="width:60px; height:60px; object-fit:cover; border-radius:8px;">
                <div style="flex:1;">
                    <h4 style="font-size:0.9rem; margin:0;">${p.name}</h4>
                    <span style="color:var(--accent-pink); font-weight:bold;">${p.price} ر.س</span>
                </div>
                <button onclick="addToCart('${p.id}')" style="background:var(--gradient-primary); color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">
                    <i class="fas fa-cart-plus"></i>
                </button>
                <button onclick="toggleWishlist('${p.id}', null); openWishlist();" style="color:#ff4757; background:none; border:none; cursor:pointer;">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        `).join('');
            }

            modal.style.display = 'flex';
            modal.classList.add('show-modal');
            document.body.style.overflow = 'hidden';
        };

        // دالة لإغلاق نافذة الأمنيات
        window.closeWishlist = function () {
            const modal = document.getElementById('wishlistModal');
            modal.style.display = 'none';
            modal.classList.remove('show-modal');
            document.body.style.overflow = 'auto';
        };

        function renderFlowerOptions() {
            document.getElementById('flowerOptions').innerHTML = singleFlowers.map(f => `
        <div class="flower-item" onclick="addFlowerToBouquet('${f.id}')">
            <img src="${f.img}">
            <h5>${f.name}</h5>
            </div>`).join('');
        }

        // ==================== دالة تغيير الكمية (جديدة) ====================
        window.changeQuantity = function (id, delta) {
            const item = cart.find(i => i.id == id);
            if (!item) return;

            // تعديل الكمية
            item.quantity = (parseInt(item.quantity) || 0) + delta;

            // إذا أصبحت الكمية 0 أو أقل، نحذف المنتج
            if (item.quantity <= 0) {
                removeFromCart(id);
            } else {
                updateCart(); // تحديث السلة بالأرقام الجديدة
                // showToast('تم تحديث الكمية'); // (اختياري: يمكنك تفعيلها لو أردت إشعاراً مع كل ضغطة)
            }
        };

        // ==================== دالة تحديث السلة (المعدلة) ====================
        function updateCart() {
            // 1. حفظ السلة في المتصفح
            localStorage.setItem('flowerCart', JSON.stringify(cart));

            // 2. حساب إجمالي عدد المنتجات
            const totalQty = cart.reduce((sum, item) => sum + parseInt(item.quantity || 1), 0);

            // تحديث العداد في الكمبيوتر
            const desktopBadge = document.querySelector('.cart-btn .badge');
            if (desktopBadge) {
                desktopBadge.textContent = totalQty;
                desktopBadge.style.display = totalQty > 0 ? 'flex' : 'none';
            }

            // تحديث العداد في الموبايل
            const mobileBadge = document.querySelector('.mobile-badge');
            if (mobileBadge) {
                mobileBadge.textContent = totalQty;
                mobileBadge.style.display = totalQty > 0 ? 'flex' : 'none';
            }

            // 3. تحديث محتوى السلة (القائمة الجانبية)
            const container = document.getElementById('cartItemsContainer');
            if (!container) return;

            let total = 0;

            // رسم العناصر داخل السلة
            container.innerHTML = cart.map(item => {
                const itemPrice = parseFloat(item.price);
                const itemQty = parseInt(item.quantity);
                const itemTotal = itemPrice * itemQty;

                total += itemTotal;

                return `
        <div style="display:flex; justify-content:space-between; padding:15px 10px; border-bottom:1px solid #eee; align-items:center;">
            
            <div style="flex:1">
                <div style="font-weight:bold; font-size:0.95rem; margin-bottom: 5px;">${item.name}</div>
                
                <div class="qty-controls" style="display: flex; align-items: center; gap: 8px;">
                    <button class="qty-btn" onclick="changeQuantity('${item.id}', 1)" style="width: 24px; height: 24px; border-radius: 50%; border: 1px solid #e75480; background: white; color: #e75480; cursor: pointer; display: flex; align-items: center; justify-content: center;">+</button>
                    <span style="font-weight: bold; min-width: 20px; text-align: center;">${itemQty}</span>
                    <button class="qty-btn" onclick="changeQuantity('${item.id}', -1)" style="width: 24px; height: 24px; border-radius: 50%; border: 1px solid #e75480; background: white; color: #e75480; cursor: pointer; display: flex; align-items: center; justify-content: center;">-</button>
                </div>
            </div>

            <div style="text-align: left; display: flex; flex-direction: column; align-items: flex-end;">
                <div style="font-weight:bold; color:var(--accent-pink); margin-bottom: 5px;">
                    ${itemTotal} ${riyalIcon}
                </div>
                <button onclick="removeFromCart('${item.id}')" style="color:red; background:none; border:none; cursor:pointer; font-size: 0.9rem;">
                    <i class="fas fa-trash"></i>
                </button>
            </div>

        </div>`;
            }).join('');

            // 4. تحديث السعر الإجمالي النهائي
            const totalEl = document.getElementById('cartTotal');
            if (totalEl) totalEl.innerHTML = total + ' ' + riyalIcon;

            const finalTotal = document.getElementById('finalTotalAmount');
            if (finalTotal) finalTotal.innerHTML = total + ' ' + riyalIcon;
        }

        // ==================== باقي الأكواد كما هي ====================

        // تعريف عناصر البحث
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');

        // الاستماع لحدث الكتابة
        searchInput.addEventListener('input', function (e) {
            const term = e.target.value.toLowerCase().trim();
            searchResults.innerHTML = ''; // مسح النتائج القديمة

            // إذا كان الحقل فارغاً، أخف القائمة
            if (term.length === 0) {
                searchResults.style.display = 'none';
                return;
            }

            // فلترة المنتجات (اسم المنتج يحتوي على النص المكتوب)
            const filteredProducts = products.filter(p => p.name.toLowerCase().includes(term));

            if (filteredProducts.length > 0) {
                searchResults.style.display = 'block';

                filteredProducts.forEach(p => {
                    const item = document.createElement('div');
                    item.className = 'search-result-item';
                    // عرض الصورة والاسم والسعر
                    item.innerHTML = `
                <img src="${p.image}" onerror="this.src='https://via.placeholder.com/50'">
                <div class="info">
                    <h4>${p.name}</h4>
                    <span>${p.price} ر.س</span>
                </div>
            `;

                    // عند الضغط على النتيجة، افتح صفحة المنتج
                    item.onclick = () => {
                        openProductPage(p.id);
                        searchResults.style.display = 'none'; // إخفاء القائمة
                        searchInput.value = ''; // تفريغ الحقل (اختياري)
                    };

                    searchResults.appendChild(item);
                });
            } else {
                // إذا لم توجد نتائج
                searchResults.style.display = 'block';
                searchResults.innerHTML = '<div style="padding:10px; text-align:center; color:#999;">لا توجد نتائج</div>';
            }
        });

        // إخفاء القائمة عند الضغط في أي مكان خارج البحث
        document.addEventListener('click', function (e) {
            if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.style.display = 'none';
            }
        });

        // دالة حذف منتج من السلة
        window.removeFromCart = function (id) {
            // 1. البحث عن مكان المنتج في المصفوفة
            const index = cart.findIndex(item => item.id == id);

            if (index > -1) {
                // 2. حذف المنتج
                cart.splice(index, 1);

                // 3. تحديث واجهة السلة وحفظ التغييرات
                updateCart();

                // 4. إظهار رسالة تأكيد
                showToast('تم حذف المنتج من السلة 🗑️');
            }
        };



    </script>

    <section id="fullProductPage">
        <div class="product-page-header">
            <button class="back-btn" onclick="closeProductPage()">
                <i class="fas fa-arrow-right"></i> رجوع
            </button>
            <h3 id="pageProductTitle" style="margin:0;">تفاصيل المنتج</h3>
        </div>

        <div class="container" style="margin-top: 20px;">
            <div class="product-details-container" style="background: transparent; box-shadow: none;">
                <div id="fullPageContent" style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px;">
                </div>
            </div>
        </div>
    </section>

    <a href="https://wa.me/966546458993" class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <div id="authModal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <span class="close-btn" onclick="document.getElementById('authModal').style.display='none'">×</span>
            <h3 style="margin-bottom: 20px; color: var(--accent-pink);">تسجيل الدخول</h3>

            <input type="email" id="emailInput" placeholder="البريد الإلكتروني" style="width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 10px;">
            <input type="password" id="passInput" placeholder="كلمة المرور" style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 10px;">

            <div style="display: flex; gap: 10px;">
                <button onclick="handleLogin(event)" class="btn-quick-add" style="flex: 1;">دخول</button>
                <button onclick="handleSignup(event)" class="btn-quick-add" style="flex: 1; background: #eee; color: #333;">حساب جديد</button>
            </div>
        </div>
    </div>

    <div id="myOrdersModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close-btn" onclick="document.getElementById('myOrdersModal').style.display='none'">×</span>
            <h3 style="text-align: center; color: var(--accent-pink); margin-bottom: 20px;">طلباتي السابقة</h3>
            <div id="myOrdersList" style="max-height: 400px; overflow-y: auto;">
            </div>
        </div>
    </div>

    <div id="wishlistModal" class="modal">
        <div class="modal-content" style="max-width: 500px; padding: 0; overflow: hidden;">
            <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid #eee;">
                <h2 style="margin: 0; font-size: 1.3rem;"><i class="fas fa-heart" style="color: #ff4757;"></i> قائمة الأمنيات</h2>
                <button class="close-wishlist-btn" onclick="closeWishlist()" style="background: #f1f1f1; border: none; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.3s;">
                    <i class="fas fa-times" style="font-size: 1.2rem; color: #555;"></i>
                </button>
            </div>

            <div id="wishlistItemsContainer" style="padding: 20px; max-height: 450px; overflow-y: auto;">
            </div>
        </div>
    </div>

</body>
</html>